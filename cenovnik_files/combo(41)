"use strict";YUI.add("tictac-smartviews",function(a){function b(a,b){return f.getAssetURL(a,"tictac-smartviews",b)}function c(a){return i?a.replace(/\.css$/,"_bidi.css"):a}var d,e,f=a.Tictac.base,g=f.getTictacVersion("smartviews"),h=g.filter||"min",i=f.isRTL,j=window.NeoConfig?window.NeoConfig.lang:"en-US";d=b("js/"),e=b("css/"),a.Tictac.base.defineModuleGroup("tictacs",{filter:h,modules:{"tictac-smartviews-rollups":{path:d+"tictac-smartviews-rollups_"+j+"-min.js"},"tictac-smartviews-strings":{path:d+"strings/lang_"+j+"-min.js"},"tictac-smartviews-controller":{path:d+"controller-min.js",requires:["tictac-smartviews","tictac-smartviews-rollups","tictac-smartviews-strings","tictac-base-mailpreferences","event-custom","tictac-smartviews-css","escape","mail-common-utils-features"]},"tictac-smartviews-onboarding":{path:d+"onboarding-min.js",requires:["tictac-smartviews-rollups","tictac-smartviews-strings","tictac-base-mailpreferences","mail-common-utils-features"]},"tictac-smartviews-css":{type:"css",path:c(e+"main.css")}}},"min"===h),YUI.namespace("Tictac").smartviews||(a.namespace("Tictac.smartviews").loader=function(){},YUI.Tictac.smartviews=a.Tictac.smartviews,a.use("tictac-smartviews-rollups","tictac-smartviews-strings","tictac-smartviews-controller","mail-common-utils-features",function(){var b,c,d,e=a.Tictac.smartviews.rollups,f=a.common.Utils.features;f.enabled("smartviewsOnLaunch")||(b=a.one("#Folders"),b&&(c=e.container({is_hidden:!0}),a.common.Utils.features.enabled("smartviewsBeforeFolders")?b.insert(c,"before"):b.insert(c,"after"))),d=a.one("#Draft"),d&&(c=a.Node.create('<li id="system-app"><ul id="system-app-list"></ul></li>'),d.insert(c,"before")),a.Tictac.smartviews.init(a.one("#smartviews"),a.one("#system-app"))})),a.namespace("Tictac").smartviews=YUI.Tictac.smartviews},"1.0.0",{requires:["tictac-base","mail-common-utils-features"]});"use strict";YUI.add("tictac-simple",function(a){function b(b,c){return a.Tictac.base.getAssetURL(b,"tictac-simple",c)}var c,d=a.common.Utils.settings.value("appid","YahooMailNeo")||"YahooMailNeo";a.namespace("Tictac").simple={loader:function(){var b,e=a.common.Utils.features,f=a.Tictac.simple,g=a.Tictac.base,h=g.getTictacVersion("simple"),i=0,j=e.enabled("simpleMe")?["me2me","unread","starred","personal","social","shopping","travel","financial"]:["unread","starred","personal","social","shopping","travel","financial"],k=!1,l={unread:"read",starred:"star",important:"address",personal:"people",social:"social",travel:"travel",shopping:"shopping",financial:"finance"};e.enabled("reminders")&&j.splice(0,0,"reminders"),e.enabled("bookmarkr")&&j.splice(0,0,"bookmarks"),f.loadModuleDefs(h.filter,g.isRTL),YUI().use("tictac-base","tictac-base-stats","tictac-base-mailpreferences","tictac-base-mailutils","tictac-smartviews","tictac-smartviews-controller","tictac-simple-rollups","tictac-simple-strings","tictac-simple-utils","tictac-simple-query","tictac-base-mail-io","tictac-simple-css","mail-common-utils-features",function(a){function f(a){var b,c,d,e,f=a.query&&a.query.keyword,g=A.mailutils;if(f&&(-1!==f.indexOf("from:")||-1!==f.indexOf("to:")||-1!==f.indexOf("fid:")))for(d=f.split(" "),c=0;c<d.length;c++)-1!==d[c].indexOf(":")&&(f=f.replace(/fid:/gi,"folderId:"),e=d[c].split(":"),b=e.pop(),g.isValidEmailAddress(b)&&(f=f.replace(/from:/gi,"fromEmail:"),f=f.replace(/to:/gi,"toEmail:")));return f}function g(a,b,e){var f,g=l[a]||a,h={personal:"EVR",travel:"FLR",shopping:"PRD"},i={type:"category",categoryName:a,adKeyword:g,partner:y};NeoConfig.imapIn&&NeoConfig.accounts.imapInAccounts&&(f=yui.mail.Controller.ImapIn,e||(e=f.getCurrentAccountId()),i.folders=[{acctIds:[e],displayName:f.getAccountAttribute(e,"description")}]),c.stat("launch_"+a),"important"===a?(i.query=b,i.displayName=F.str_important,i.shouldParseKeyword=!1,i.view=a):"me2me"===a?(i.view=a,i.email=NeoConfig.emailAddress,i.displayName=F.str_me2me):(i.query="is:"+a,i.view=a,i.shouldParseKeyword=!0),yui.fire("search:setSmartView","",i),yui.fire("search:input",{appid:d,foldername:1,tzoffset:-28800,start:0,count:100,sorting:"-date",customTitle:{noLabel:!0,value:F["str_"+a]},noRefine:!0,addToRecentSearches:!1,displayQueryInSearchBar:"",disableScrollToSearch:!0,query:{predictiveSearchType:h[a],keyword:b,group:{from:{},folder:{},flags:{order:"desc"},attachmenttype:{},date:{unit:"year"}},flags:{softdelete:0},adKeyword:g,smartViewType:a,partner:y,typeTag:"smartview_"+a}})}function h(b){var c,d,f="",g=!1;"important"===b&&(f=e.enabled("importantNotifications")?"system":"",g=e.enabled("important")?!0:!1),e.enabled("smartviewsOnLaunch")?(c=yui.one('[data-id="simple-'+b+'"]'),"important"===b&&a.use("tictac-important",function(a){a.Tictac.important.launcher()})):c=a.Tictac.smartviews.addView({viewId:"simple-"+b,name:F["str_"+b],title:F["str_"+b],type:f,settings:g}),e.enabled("importantNotifications")&&"important"===b&&t(function(c){c>i&&(d=c-i,yui.use("mail-ui-desktop-notifications",function(a){a.mail.ui.desktopNotifications.notify("Yahoo Mail - Important",d+" New Emails",function(){},5e3)})),i=c,c&&a.Tictac.smartviews.updateView({viewId:"simple-"+b,name:F["str_"+b]+" ("+c+")",title:F["str_"+b]+" ("+c+")",type:"system",settings:!0})}),c.on("launch",function(){n(b)})}function m(b,d){var f,g=[],h=E.getCustomName(b.name),i=b.viewId;e.enabled("smartviewsOnLaunch")&&!d?(f=yui.one('[data-id="simple-custom-'+i+'"]'),f.setData("name",h)):f=a.Tictac.smartviews.addView({viewId:"simple-custom-"+i,name:h,type:"custom",custom:!0}),"Contact"===b.type?g.push(f.on("launch",function(){yui.fire("search:setSmartView","",{view:b.viewId,displayName:b.name,typeTag:"smartview_custom_contact"}),c.stat("launch_custom",{type:"Contact"})})):g.push(f.on("launch",function(){yui.fire("search:setSmartView","",{view:b.viewId,displayName:b.name,typeTag:"smartview_custom_keyword"}),c.stat("launch_custom",{type:"Keyword"})})),g.push(f.on("rename",function(a){b.name=E.getCustomName(a),b.query&&(b.query.smartViewType=E.getCustomName(a)),c.stat("custom_rename",{type:b.type}),B.set("simpleCustomViews",C),B.save(),yui.fire("simple:customViewsChanged")})),g.push(f.on("remove",function(){var d=a.Array.indexOf(C,b);c.stat("custom_remove",{type:b.type}),C.splice(d,1),B.set("simpleCustomViews",C),B.save(),yui.fire("simple:customViewsChanged"),a.Array.each(g,function(a){a.detach()})}))}function n(b,c){var d;switch(b){case"important":D=B.get("importantQuery")||D,d=D+(e.enabled("searchresults")?"":" folder:>0 -folder:2 -folder:3 -folder:4 -folder:8"),g(b,d,c);break;case"me2me":g(b);break;case"unread":case"starred":case"personal":case"social":case"travel":case"shopping":case"financial":d="is:"+b+" folder:>0 -folder:3 -folder:4 -folder:8",g(b,d,c);break;default:yui.fire("view:"+b+":launch"),a.log(b)}}function o(b,c){var d=F["str_"+b],f={category_name:b,category_string:d,category_class:"category-label"};return e.enabled("v2SmartTag")?f.category_class="categoryv2":e.enabled("v3SmartTag")&&(f.category_class="categoryv3"),NeoConfig.imapIn&&NeoConfig.accounts.imapInAccounts&&(f.showAccountName=!0,f.account_name=yui.mail.Controller.ImapIn.getAccountAttribute(c,"description"),f.account_name=yui.common.Utils.escapeHtml(f.account_name),f.account_email=yui.mail.Controller.ImapIn.getAccountAttribute(c,"email"),f.category_class="categoryv3"),yui.Node.create(a.Tictac.simple.rollups.category(f))}function p(b){var c={};return NeoConfig.imapIn&&NeoConfig.accounts.imapInAccounts?(c.account_name=yui.mail.Controller.ImapIn.getAccountAttribute(b,"description"),c.account_name=yui.common.Utils.escapeHtml(c.account_name),c.account_email=yui.mail.Controller.ImapIn.getAccountAttribute(b,"email"),yui.Node.create(a.Tictac.simple.rollups.account(c))):""}function q(a){var b=a.ancestor(".thread-content")||a;return b.one(".message-header")}function r(a,b,d){var e=q(a),f=yui.mail.ui.FolderUtils.getAcctIdByFid(d);e&&(b=b&&b.toLowerCase(),e.hasClass("simple-header")||(e.addClass("simple-header"),e.one(".msg-attachment")&&e.addClass("simple-header-attachment"),b?e.appendChild(o(b,f)).on("click",function(a){c.stat("message_"+b),n(b,f),a.halt()}):e.appendChild(p(f))))}function s(a,b){var c,d,e=b.classification,f={P:"Personal",S:"Social",T:"Travel",H:"Shopping",F:"Financial",U:"Unknown",O:"Other",C:"Other",M:"Other"},g=["@yahoo.com","@ymail.com","@rocketmail.com","@gmail.com","@hotmail.com","@outlook.com"],h=new RegExp(g.join("$|")+"$","i"),i=b.fid||b.sourceFolderInfo&&b.sourceFolderInfo.fid;return e&&e.category&&(c=f[e.category],"Unknown"===c&&(d=b&&b.header&&b.header&&b.header.from&&b.header.from.email,c=d.match(h)?"Personal":null),c&&j.indexOf(c.toLowerCase())>-1)?void r(a,c,i):void r(a,null,i)}function t(a){var b,c="/mailsearch/v2/search";D=B.get("importantQuery")||D,b=D+" is:unread",yui.use("tictac-base-mail-io").then(function(e){e.Tictac.base.mailIO.send(c,{data:{appid:d,query:JSON.stringify({keyword:b}),wssid:NeoConfig.wssid},method:"get",on:{success:function(){a(e.Object.getValue(arguments,[2,"total"]))}}})}),window.setInterval(function(){yui.use("tictac-base-mail-io").then(function(e){D=B.get("importantQuery")||D,b=D+" is:unread",e.Tictac.base.mailIO.send(c,{data:{appid:d,query:JSON.stringify({keyword:b}),wssid:NeoConfig.wssid},method:"get",on:{success:function(){a(e.Object.getValue(arguments,[2,"total"]))}}})})},1e4)}function u(){var a;for(a=0,b=j.length;b>a;a++)h(j[a]);for(a=0,b=C.length;b>a;a++)m(C[a]);yui.fire("simple:rendered")}function v(b){b.name=b.name?E.getCustomName(b.name):E.getAccountName()||F.str_branding_generic_smart_view,b.type=b.type?b.type:"Keyword",b.viewId=b.name.replace(/[^a-zA-Z]/g,"")+ +new Date,m(b,!0),C.push(b),a.Tictac.smartviews.revealView("simple-custom-"+b.viewId),B.set("simpleCustomViews",C),B.save(),yui.fire("simple:customViewsChanged"),yui.use("mail-ui-onboarding","tictac-base-utils","tictac-simple-rollups","common-utils",function(a){var c=a.common.Utils,d=a.Tictac.base.utils.subs(F.str_custom_view_launch_tip,{name:a.Escape.html(b.name)}),e=c.ezSub(a.Tictac.simple.rollups.tooltip({str_nav_ob_callout:d})),f=a.one("#smartviews-app-list li:last-child");a.fire("onboard:tip",{node:f,template:e,fn:function(){a.fire("onboard:tipclose")},dir:"left",offset:[f.get("offsetWidth")+5,-20]}),a.one("document").once("click",function(){a.fire("onboard:tipclose")}),a.later(2e3,this,function(){a.fire("onboard:tipclose")})})}var w,x,y="yahoo_mail_search_smartviews",z=[],A=a.Tictac.base,B=A.mailpreferences,C=B.get("simpleCustomViews")||[],D=B.get("importantQuery"),E=a.Tictac.simple.Utils,F=a.Tictac.simple.strings;if(!B.get("simpleLMV3Migrated")){for(x=0;x<C.length;x++)C[x].query||(C[x].query={keyword:""}),w=f(C[x]),C[x].query.keyword=w,B.set("simpleCustomViews",C),B.save();B.set("simpleLMV3Migrated",!0),B.save()}D&&(D=D.replace(/fromaddress/gi,"fromEmail"),B.set("importantQuery",D),B.save()),e.enabled("important")&&(k=B.get("isXobnified"),k||yui.xobniContacts.isXobnified(function(a){a&&(k=a,B.set("isXobnified",a),B.save())})),c=new a.Tictac.base.Stats({name:"simple",yamas:!0}),c.stat("launch"),yui.on("simple:registerCustomView",v),k&&j.splice(0,0,"important"),u(),e.enabled("customViews")&&yui.on("simple:onSearchComplete",function(b,d){var e,f,g=a.Node.create(a.Tictac.simple.rollups.pin());if(b){if(f=a.one(".tictac-contactdetails-header-filter .contactname"),!f)return;for(f.insert(g),e=0;e<C.length;e++)if(C[e].email&&C[e].email===d.email)return g.set("text",F.str_saved),g.setAttribute("disabled","disabled"),void g.setAttribute("title",F.str_saved_as_smart_view);g.on("click",function(a){v({name:d.name,email:d.email,type:"Contact"}),c.stat("custom_save",{type:"Contact"}),yui.fire("util:ymstats",{name:"srp_header_smartview_custom_save",tags:{type:"contact"}}),g.set("text",F.str_saved),g.setAttribute("disabled","disabled"),g.setAttribute("title",F.str_saved_as_smart_view),g.detach("click"),a.halt()})}else{if(f=a.one(".refinement-top-bar-text"),!f)return;for(f.insert(g),e=0;e<C.length;e++)if(C[e].query&&C[e].query.keyword===d.keyword)return g.set("text",F.str_saved),g.setAttribute("disabled","disabled"),void g.setAttribute("title",F.str_saved_as_smart_view);g.on("click",function(b){var e=a.clone(d);e.smartViewType=E.getCustomName(d.keyword),v({name:d.keyword,query:e}),c.stat("custom_save",{type:"Keyword"}),yui.fire("util:ymstats",{name:"srp_header_smartview_custom_save",tags:{type:"keyword"}}),g.set("text",F.str_saved),g.setAttribute("disabled","disabled"),g.setAttribute("title",F.str_saved_as_smart_view),g.detach("click"),b.halt()})}}),yui.on("MessagePane:rendered",function(b,c,d){var e,f,g=q(d),h=a.Object.getValue(c,["header","from","email"]),i=[h];if(g&&!g.one(".category"))if(k){for(e=!1,f=0;f<i.length;f++)if(-1!==z.indexOf(i[f])){e=!0;break}e?r(d,"important"):s(d,c)}else s(d,c)})})},loadModuleDefs:function(c,d){function e(a){return d?a.replace(/\.css$/,"_bidi.css"):a}var f=b("js/"),g=b("css/"),h=window.NeoConfig?window.NeoConfig.lang:"en-US";c=c||"min",a.Tictac.base.defineModuleGroup("simple",{filter:c,modules:{"tictac-simple-rollups":{path:f+"tictac-simple-rollups_"+h+"-min.js",requires:["handlebars-base"]},"tictac-simple-strings":{path:f+"strings/lang_"+h+"-min.js",requires:[]},"tictac-simple-utils":{path:f+"utils-min.js",requires:[]},"tictac-simple-query":{path:f+"query-min.js",requires:["tictac-simple-strings","xobni-contacts-search-api","mail-common-utils-features"]},"tictac-simple-css":{type:"css",path:e(g+"simple.css")}}},"min"===c)}}},"1.0.0",{requires:["tictac-base","tictac-smartviews","isXobnifiedCheck","xobni-contacts-search-api","mail-common-utils-features","mail-common-utils-settings","escape","mail-ui-folder-utils","common-utils"]});YUI.add("tictac-autosuggest",function(a){"use strict";a.namespace("Tictac").autosuggest={loader:function(){function b(b,c){return a.Tictac.base.getAssetURL(b,"tictac-autosuggest",c)}function c(b){return a.Tictac.base&&a.Tictac.base.isRTL?b.replace(/\.css$/,"_bidi.css"):b}function d(){return a.common.Utils.settings.value("appid")}function e(b,c){if(!h){var d=["contains","destructor","detach","fire","generateID","getItemMarkup","handleEscape","hide","isVisible","on","one","hasItemSelected","refresh","render","set","setAlign","setSize"],e={},f=null;a.Array.each(d,function(a){e[a]=!0}),c&&c.contacts&&c.contacts.ui&&c.contacts.ui.ACWidget&&c.contacts.ui.ACWidget.prototype&&(f=c.contacts.ui.ACWidget.prototype),b.ACWidgetInst=h=c.autosuggest.tictac.shim.create(f,d,{canHandleEnter:function(){return!0},get:function(a){return"data"===a?"data":this},handleEnter:function(){}})}}function f(a){k||(k=new a.Tictac.base.Stats({name:"autosuggest",yamas:!0}))}function g(c){f(c),e(a,c),i=a.Tictac.base.getTictacVersion("autosuggest").filter,j=window.NeoConfig?window.NeoConfig.lang:"en-US",a.log("Taking over autosuggest.","debug"),k.stat("info",{intl:NeoConfig.intl,farm:NeoConfig.farm,internal:(!!NeoConfig.isInternal).toString()}),a.Tictac.base.defineModuleGroup("autosuggest",{filter:i,modules:{"tictac-autosuggest-rollups":{path:b("js/tictac-autosuggest-rollups_"+j+"-min.js"),requires:["handlebars-base"]},"tictac-autosuggest-strings":{path:b("js/strings/lang_"+j+"-min.js")},"autosuggest-highlight-helper":{path:b("js/autosuggesthighlighthelper-min.js")},"autosuggest-response-formatter":{path:b("js/autosuggestresponseformatter-min.js"),requires:["autosuggest-highlight-helper","handlebars-base"]},"autosuggest-api":{path:b("js/autosuggestapi-min.js"),requires:["autosuggest-response-formatter","io-base","querystring-stringify","event-base","querystring-parse","autosuggest-search-performance","autosuggest-api-mail-endpoints","autosuggest-api-state"]},"autosuggest-api-cache":{path:b("js/autosuggestapicache-min.js"),requires:["autosuggest-api","autosuggest-api-cache-object"]},"autosuggest-api-factory":{path:b("js/autosuggestapifactory-min.js"),requires:["autosuggest-api","autosuggest-api-cache"]},"autosuggest-social-footer":{path:b("js/socialfooter-min.js"),requires:["event","tictac-autosuggest-rollups","mail-common-utils-features"]},"autosuggest-compose-utils":{path:b("js/autosuggestcomposeutilities-min.js"),requires:["tictac-autosuggest-rollups"]},"tictac-autosuggest-compose":{path:b("js/autosuggesttictaccompose-min.js"),requires:["node","event","autosuggest-social-footer","autosuggest-main","autosuggest-api","tictac-base-mailpreferences","comms-intl-bidi","handlebars-base","common-net-session","autosuggest-compose-utils","autosuggest-api-factory","autosuggest-prefetch-store","autosuggest-api-mail-endpoints"]},"autosuggest-footer-manager":{path:b("js/autosuggestfootermanager-min.js")},"autosuggest-main":{path:b("js/autosuggestmain-min.js"),requires:["node","autocomplete","event","autosuggest-footer-manager","autosuggest-api","autosuggest-css","tictac-autosuggest-rollups"]},"autosuggest-api-mail-endpoints":{path:b("js/autosuggestapimailendpoints-min.js"),requires:["mail-common-utils-features"]},"autosuggest-standalone-loader":{path:b("js/standaloneloader-min.js"),requires:["autosuggest-api","autosuggest-main","autosuggest-standalone-helper","querystring-parse","autosuggest-api-factory"]},"autosuggest-standalone-helper":{path:b("js/autosuggeststandalonehelper-min.js"),requires:["autosuggest-compose-utils"]},"autosuggest-tictac-stats":{path:b("js/autosuggesttictacstats-min.js"),require:["event-base"]},"autosuggest-prefetch-store":{path:b("js/prefetchstore-min.js")}}},"min"===i),m||(m=YUI()),l||m.use("autosuggest-tictac-stats",function(a){l=new a.autosuggest.tictac.Stats(a,k)}),yui.on("autosuggest:standalone:initialize",function(a){q&&q.isXobnified&&a.id&&q.isXobnified(function(b){b&&q.isXobniAvailable(function(b){b&&m.use("autosuggest-standalone-loader",function(b){p[a.id]=b.Array.map(a.inputSelectors,function(c){return b.autosuggest.standalone.init(b.one(c),b.mix(a.config,{getAppid:d,xobniBaseURL:r}))})})})})}),yui.on("autosuggest:standalone:destroy",function(b){b.id&&b.id in p&&(a.Array.each(p[b.id],function(a){a.detach(),a.destroy()}),delete p[b.id])}),a.on("FullCompose:fullComposeReady",function(a){var b=a.context,c=b&&b.header,e=b&&b.draft&&b.draft.from&&b.draft.from.email;m.use("tictac-autosuggest-compose",function(b){var f=b.autosuggest.tictac.compose.create(),g={yBaseNode:a.rte.baseNode,shim:h,fromAccount:e||"",apiConfig:{xobniBaseURL:r,getAppid:d},showPerf:1===n.xShowPerf,useCache:1!==n.xDisableCache};f.init(g),c&&c.on("closeChange",function(a){1===a.newVal&&f.destroy()})})})}var h,i,j,k,l,m,n=a.QueryString.parse(window.location.search.substr(1)),o=1===n.disableAutosuggest,p={},q=a.xobniContacts,r=q.Utils.getXobniBaseURL().url;return o?void a.log("Autosuggest disabled via URL flag."):void a.use("ac-widget","tictac-autosuggest-shim","isXobnifiedCheck","get","tictac-base-stats",function(a){var d=!1,e=!1,h=function(){d&&e&&g(a)};q&&q.isXobnified?(q.isXobnified(function(a){a&&q.isXobniAvailable(function(a){a&&(d=!0,h())})}),a.Get.css(c(b("css/autosuggest.css",!0)),function(b){return b?(a.log("Error loading CSS: "+b[0].error),f(a),void k.stat("cssFailToLoad",{browser_info:NeoConfig.browser,farm:NeoConfig.farm,error:b[0].error})):(e=!0,void h())})):a.log("isXobnifiedCheck doesn't exist")})}}},"1.0.0",{requires:["tictac-base","querystring-parse","io-base","mail-common-utils-settings","xobni-utilities"]}),YUI.add("tictac-autosuggest-shim",function(a){"use strict";a.namespace("autosuggest.tictac").shim={create:function(b,c,d,e){function f(a,b){return a&&"string"==typeof a&&"__setHandler__"!==a&&"__unsetHandler__"!==a&&!m[a]&&b&&"function"==typeof b}var g,h,i,j,k={},l=d&&"object"==typeof d?d:{},m={};l.__setHandler__=function(a,b){return f(a,b)?(k[a]||(k[a]=[]),k[a].push(b),!0):!1},l.__unsetHandler__=function(a,b){var c,d,e;if(f(a,b)&&(e=k[a]))for(c=0,d=e.length;d>c;++c)if(e[c]===b)return e.splice(c,1),!0;return!1},g=function(a,b){var c,d,f;if(e&&e(a),k[a]&&k[a].length){for(c=!1,d=0,f=k[a].length;f>d;++d)"function"==typeof k[a][d]&&(c=c||!!k[a][d]());return c}return b};for(h in l)m[h]=!0;for(i in b)l[i]||(j=b[i],"function"==typeof j?l[i]=a.bind(g,this,i,l):("string"==typeof j||"number"==typeof j||"boolean"==typeof j)&&(l[i]=b[l]));return a.Array.each(c,function(b){l[b]||(l[b]=a.bind(g,this,b,l))}),l}}},"1.0.0");YUI.add("tictac-attach",function(a){"use strict";function b(){return-1!==window.location.href.indexOf("autolinkOff")&&NeoConfig.isInternal?!1:window.getSelection?!0:!1}function c(){return e&&b()}function d(a,b){return g.getAssetURL(a,"tictac-attach",b)}var e=a.common.Utils.features.enabled("ComposeWithCard"),f=!1;NeoConfig.linkEnhancrEnabled=c(),NeoConfig.autolinkEnabled=b(),a.namespace("Tictac.attach").loader=function(){f||(yui.use("mail-services-plugins",function(a){a.Mail.Services.Plugins.register("composeEditor",{getPlugin:function(){return new Promise(function(b){a.use("tictac-attach-enhancr-autolink",function(a){b(a.Tictac.attach.enhancr.AutolinkPlugin)})})}}),a.Mail.Services.Plugins.register("composeEditor",{getPlugin:function(){return new Promise(function(b){a.use("tictac-attach-enhancr-card",function(a){b(a.Tictac.attach.enhancr.CardPlugin)})})}})}),NeoConfig.linkEnhancrEnabled&&a.use("tictac-base-mailpreferences",function(a){var b=window.NeoConfig,c=a.Tictac.base.mailpreferences,d=c.get("enhancrLinkPreviewEnabled")||"1",e=c.get("hasShownEnhancrOnboarding");(-1===window.location.href.indexOf("enhancrTutorial")||!NeoConfig.isInternal&&"f9323"!==NeoConfig.farm)&&("-1"===d||e||b.showTabsCallout||b.showNavCallout||b.showOlympicCallout||b.isRegOnboardingEnabled||a.common.Utils.isLaunchOnboardingShown()||a.common.Utils.features.enabled("scout")||b.onboardPC)||a.use("tictac-attach-stats","tictac-attach-rollups","mail-ui-onboarding","comms-ui-tooltips-widget","tictac-attach-strings",function(a){var d=a.Tictac.attach.Stats.stat,e=a.common.Utils.features.enabled("composev3");c.set("hasShownEnhancrOnboarding",!0),c.save(),b.showingEnhancrTooltip=!0,a.common.Utils.setLaunchOnboardingShown(1),a.fire("onboard:tip",{node:a.one("#Compose"),template:a.Tictac.attach.rollups.enhancr_card_onboarding({imgUrl:"https://s.yimg.com/nq/a/img/thm/enhancr_onboarding_03122014.png"}),fn:function(b){var c=b.target;c.test(".tutorial-btn.close")?(d("enhancr_promo_close_dialog"),a.fire("onboard:tipclose")):c.hasClass("okayModalOverlay")||"A"===c.get("tagName")?(d("enhancr_promo_try_it"),a.fire("newMessage",{cbfn:function(b){var c=a.Tictac.attach.strings,d=a.Tictac.attach.rollups;e?(b.setHeader({subject:c.str_link_preview_tutorial_subject}),b.setBody(null,d.link_enhancr_promo())):(b.set("header",{subject:c.str_link_preview_tutorial_subject}),b.set("content",d.link_enhancr_promo())),a.Lang.later(0,null,function(){var b=document.createRange(),c=a.one("#link-enhancr-promo-email-try-pasting").getDOMNode();a.one("#rtetext").focus(),b.setStartAfter(c),document.getSelection().removeAllRanges(),document.getSelection().addRange(b)})}}),a.fire("onboard:tipclose")):b.halt()},dir:"left",width:280,offset:[120,-10]})})}),f=!0)};var g=a.Tictac.base,h=g.isRTL,i=g.getTictacVersion("attach"),j=window.NeoConfig?window.NeoConfig.lang:"en-US";a.Tictac.base.defineModuleGroup("tictacs",{filter:i.filter,modules:{"tictac-attach-model-attachment":{path:d("js/attachment-min.js"),requires:["tictac-base-utils","tictac-attach-utils","escape"]},"tictac-attach-model-attachments":{path:d("js/attachments-min.js"),requires:["array-extras","event-custom","tictac-base-utils","tictac-attach-model-attachment","tictac-attach-utils","tictac-att-filter"]},"tictac-attach-controller":{path:d("js/controller"+(e?"":"_nocard")+"-min.js"),requires:["tictac-attach-neo","tictac-attach-uploader-form","tictac-attach-model-attachments","tictac-attach-utils","tictac-base-stats","tictac-base-utils"]},"tictac-attach-customuploader-html5":{path:d("js/customuploaderhtml5-min.js"),requires:["uploader-html5","tictac-attach-yuipatch"]},"tictac-attach-enhancr-autolink":{path:d("js/enhancr-autolink"+(e?"":"_nocard")+"-min.js"),requires:["tictac-attach-stats","tictac-attach-utils","base","plugin","event-custom","event-key","node-base"]},"tictac-attach-enhancr-card":{path:d("js/enhancr-card-min.js"),requires:["tictac-attach-enhancr-net","tictac-attach-stats","tictac-base-utils","tictac-base-mailpreferences","array-extras","escape","querystring-stringify-simple","base","tictac-attach-rollups","tictac-attach-strings","event-custom","comms-ui-envelope"]},"tictac-attach-enhancr-net":{path:d("js/enhancr-net-min.js"),requires:["common-net-sessionmgr","tictac-base-utils","tictac-base-mail-io"]},"tictac-attach-enhancr-monetizr":{path:d("js/enhancr-monetizr-min.js"),requires:[]},"tictac-attach-main":{path:d("js/load"+(e?"":"_nocard")+"-min.js"),requires:["event-custom","tictac-att-filter","tictac-attach-enhancr-autolink","tictac-attach-enhancr-card","tictac-attach-neo","tictac-attach-stats","tictac-attach-model-attachments","tictac-attach-view","tictac-attach-controller","tictac-attach-uploader-form","tictac-attach-uploader-html5","tictac-attach-strings","tictac-attach-utils","tictac-base-utils"]},"tictac-attach-neo":{path:d("js/neo"+(e?"":"_nocard")+"-min.js"),requires:[]},"tictac-attach-stats":{path:d("js/stats"+(e?"":"_nocard")+"-min.js"),requires:["tictac-base-stats"]},"tictac-attach-uploader":{path:d("js/uploader-min.js"),requires:["event-custom"]},"tictac-attach-uploader-form":{path:d("js/uploaderform-min.js"),requires:["event-custom","querystring-parse-simple","tictac-base-utils","tictac-attach-utils"]},"tictac-attach-uploader-html5":{path:d("js/uploaderhtml5"+(e?"":"_nocard")+"-min.js"),requires:["array-extras","event-custom","io","tictac-attach-customuploader-html5","tictac-attach-neo","tictac-attach-rollups","tictac-attach-strings","tictac-attach-utils","tictac-base-utils"]},"tictac-attach-utils":{path:d("js/utils-min.js"),requires:["node","json"]},"tictac-attach-view":{path:d("js/view"+(e?"":"_nocard")+"-min.js"),requires:["base-base","node","tictac-base-utils","tictac-attach-utils","tictac-att-attachment-tray","tictac-att-filter","tictac-att-attachment-compose","tictac-att-attachment-error","tictac-att-attachments","tictac-attach-rollups","tictac-att-downloader"]},"tictac-attach-yuipatch":{path:d("js/yuipatch-min.js"),requires:["file-html5","uploader-queue"]},"tictac-attach-strings":{path:d("js/strings/lang_"+j+"-min.js")},"tictac-attach-rollups":{path:d("js/tictac-attach-rollups_"+j+"-min.js")}}}),a.one("head").append('<link rel="stylesheet" href="'+d(h?"css/attach"+(e?"":"_nocard")+"_bidi.css":"css/attach"+(e?"":"_nocard")+".css","tictac-attach",!0)+'" class="tictac-attach-css" />'),a.common.Utils.features.enabled("linkPreviewMonetizer")&&a.use("tictac-attach-enhancr-monetizr")},"1.0.0",{requires:["tictac-base","tictac-att","mail-common-utils-features"]});require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d='body.docpreview-on .assist-container{background:#FAFAFA}body.docpreview-on.vp-nomin.vp-on{min-width:1024px}body.docpreview-on #main #toolbar{width:50%}@media screen and (max-width:1500px){body.docpreview-on #main #toolbar .btn>.icon-text{display:none}}body.docpreview-on.archive-on #main #toolbar .btn>.icon-text{display:none}body.docpreview-on.docpreview-expanded #main #toolbar{display:none}body.docpreview-on.docpreview-presentation #shellcontent #shellinner{top:0}body.docpreview-on.docpreview-presentation #shellcontent #tabs{display:none}body.docpreview-on.docpreview-presentation #main #shellcontent{left:0}body.docpreview-on.docpreview-presentation #main #shellnavigation{display:none}body.docpreview-on.docpreview-presentation #main #nav{display:none}body.docpreview-on.docpreview-presentation #UH{display:none}body.uh3.docpreview-on.docpreview-presentation #main{top:0;margin:0}body.docpreview-on.docpreview-presentation #UH{display:none}.hidden{display:none}.previewr-wrapper{height:100%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-family:"Helvetica Neue","Segoe UI",Helvetica,Arial,"Lucida Grande",sans-serif;font-size:13px;font-weight:400}.previewr-wrapper .icon{font-style:normal;font-weight:400;font-family:mail;speak:none;display:inline-block;cursor:pointer;font-size:20px;margin-right:16px}.previewr-wrapper .icon.no-padding{padding:0}.previewr-wrapper .icon-arrow-up::before{content:"\\e021"}.previewr-wrapper .icon-folder::before{content:"\\e00c"}.previewr-wrapper .icon-alert::before{content:"\\e050"}.previewr-wrapper .icon-encrypt::before{content:"\\e611"}.previewr-wrapper .icon-expand::before{content:"\\e607"}.previewr-wrapper .icon-shrink::before{content:"\\e606"}.previewr-wrapper .icon-zoom-out::before{content:"\\e06a"}.previewr-wrapper .icon-zoom-in::before{content:"\\e06b"}.previewr-wrapper .icon-close::before{content:"\\e016"}.previewr-wrapper .icon-play::before{content:"\\e044"}.previewr-wrapper .icon-download::before{content:"\\e04b"}.previewr-wrapper .icon-arrow-left::before{content:"\\e077"}.previewr-wrapper .icon-arrow-right::before{content:"\\e078"}.previewr-wrapper .icon-refresh::before{content:"\\e049"}.previewr-wrapper .icon-fullscreen::before{content:"\\e62d"}.previewr-wrapper .icon-attachment-big::before{content:"\\f604"}.previewr-wrapper .icon-compressed::before{content:"\\f605"}.previewr-wrapper .icon-doc::before{content:"\\f606"}.previewr-wrapper .icon-music::before{content:"\\f607"}.previewr-wrapper .icon-pdf::before{content:"\\f608"}.previewr-wrapper .icon-ppt::before{content:"\\f609"}.previewr-wrapper .icon-spreadsheet::before{content:"\\f60a"}.previewr-wrapper ::-webkit-scrollbar{width:10px;height:10px}.previewr-wrapper ::-webkit-scrollbar-thumb{border-radius:5px}.previewr-wrapper .delay-visiblity{-webkit-animation:showanim 1s step-end 0s;-moz-animation:showanim 1s step-end 0s;animation:showanim 1s step-end 0s}@-webkit-keyframes showanim{0%{opacity:0}100%{opacity:1}}@-moz-keyframes showanim{0%{opacity:0}100%{opacity:1}}@keyframes showanim{0%{opacity:0}100%{opacity:1}}.previewr-wrapper .viewer-wrapper{background:#FAFAFA;position:absolute;top:37px;bottom:0;left:0;right:0;border-left:1px solid #e4e4e4;outline:0;overflow:auto}.previewr-wrapper .nav-handles{display:inline;z-index:10;background:rgba(0,0,0,.7);cursor:pointer;width:32px;height:40px;border-radius:2px}.previewr-wrapper .nav-handles::before{font-family:mail;content:"\\e058";font-size:34px;color:#fff;opacity:1;line-height:40px}.previewr-wrapper .nav-handles:hover{cursor:pointer}.previewr-wrapper .nav-handles.disabled:hover{cursor:default}.previewr-wrapper .nav-handles.disabled::before{opacity:.4}.previewr-wrapper .nav-rtl-tranform{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);transform:rotate(180deg)}.previewr-wrapper .nav-handles.next{margin-left:1px}.previewr-wrapper .nav-handles.prev{margin-right:1px}.previewr-wrapper .nav-handles.next:before{content:"\\e057"}.previewr-wrapper .back-msg-btn .btn-label{padding-top:3px;display:inline-block}.previewr-wrapper .back-msg-btn:hover .back-hover-msg{width:390px;padding:0 20px 20px}.previewr-wrapper .doc-title{padding:0 12px 0 16px;display:inline-block;vertical-align:top;font-weight:700;padding-top:2px}.previewr-wrapper .doc-title .file-name{display:inline-block;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:middle}.previewr-wrapper .doc-title .dot{display:none}.previewr-wrapper .dot{display:inline-block;margin:0 16px 0 0;font-size:16px;line-height:13px;vertical-align:middle}.previewr-wrapper .control-box-wrapper{position:absolute;height:40px;bottom:50px;z-index:20;left:0;right:0;display:none;text-align:center}.previewr-wrapper .control-box-wrapper .control-box{height:100%;color:#fff;display:inline-block}.previewr-wrapper .control-box-wrapper .control-box .control-box-inner{float:left;border-radius:2px;background:rgba(0,0,0,.7)}.previewr-wrapper .control-box-wrapper .control-box .icon{line-height:40px;vertical-align:bottom;padding:0;margin:0 10px;opacity:1}.previewr-wrapper .control-box-wrapper .control-box .icon:hover{cursor:pointer}.previewr-wrapper .control-box-wrapper .control-box .icon.disabled{opacity:.4;cursor:default}.previewr-wrapper .control-box-wrapper .control-box .icon.disabled:hover{cursor:default}.previewr-wrapper .control-box-wrapper .control-box .icon-zoom-in{margin-left:5px}.previewr-wrapper .control-box-wrapper .control-box .icon-zoom-out{margin-right:5px}.previewr-wrapper .page-navigator{padding:2px 16px 0 0;display:inline-block;vertical-align:top;opacity:1}.previewr-wrapper .expanded-icons{display:inline-block;padding-left:16px;padding-right:8px;cursor:pointer}.previewr-wrapper .expanded-icons .icon{padding-right:12px;margin-right:0}.previewr-wrapper .f-left{float:left}.previewr-wrapper .f-clear{clear:both}.previewr-wrapper .v-top{vertical-align:top}.previewr-wrapper .v-top{vertical-align:top}.previewr-wrapper .f-right{float:right}.previewr-wrapper .toolbar-docstyle{position:absolute;top:0;left:1px;right:0;background:rgba(255,255,255,.3);padding:8px 0 9px;z-index:11;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.previewr-wrapper .toolbar-docstyle .page-nav-disp{border-radius:2px;padding:2px 4px;margin:0 4px;color:#000;background:rgba(0,0,0,.1)}.previewr-wrapper .toolbar-docstyle .page-nav-input{width:25px;outline:0;height:16px;margin-right:4px;background:#fff;color:#000}.previewr-wrapper .toolbar-borderdiv{position:absolute;top:0;left:0;right:0;width:1px;height:37px;opacity:.1;line-height:37px;z-index:11}.previewr-wrapper .back-hover-msg{width:0;overflow:hidden;position:absolute;top:16px;left:0;color:#000;-webkit-transition:all 0s step-start .3s;-moz-transition:all 0s step-start .3s;transition:all 0s step-start .3s}.previewr-wrapper .back-hover-msg .from-header{margin-bottom:15px}.previewr-wrapper .back-hover-msg .from-header h2{display:inline-block;font-weight:700;font-size:1em;margin:0}.previewr-wrapper .back-hover-msg .thread-quoted-text{display:none}.previewr-wrapper .back-hover-msg .inner-content{margin-top:17px;overflow:auto;border-radius:3px;padding:30px;max-height:390px;box-shadow:0 5px 10px rgba(0,0,0,.36);background:#fff}.previewr-wrapper .viewer-message{height:40px;position:absolute;top:50%;font-size:18px;text-align:center;color:gray;margin:-20px auto 0;width:100%}.previewr-wrapper .viewer-message .message-icon i{font-size:2rem;padding:0}.previewr-wrapper .viewer-message .message{font-size:14px}.previewr-wrapper .viewer-message .download-att{margin-left:0;margin-right:5px;color:#196ad4}.previewr-wrapper .viewer-message .download-att:hover{cursor:pointer}.previewr-wrapper .viewer-message .retry-preview{margin-left:5px;margin-right:0;color:#196ad4}.previewr-wrapper .viewer-message .retry-preview:hover{cursor:pointer}.previewr-wrapper .viewer-message>div{padding-bottom:5px}.previewr-wrapper .viewer-message.pwd-protected{color:gray;width:100%;font-weight:500px}.previewr-wrapper .viewer-message.pwd-protected .message-icon{margin-bottom:15px}.previewr-wrapper .viewer-message.pwd-protected input{padding:5px 3px 5px 3px}.previewr-wrapper .viewer-message.pwd-protected .failed{color:red}.previewr-wrapper .viewer-message.pwd-protected .loader{width:100%;height:30px;margin-top:10px}.previewr-wrapper .zip-navigator-title-container .zip-navigator-title{margin-left:5px;position:relative;top:-2px;display:inline-block;max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:700}.previewr-wrapper .zip-navigator-title-container .zip-navigator-title:hover{cursor:pointer}.previewr-wrapper .zip-navigator-title-container .zip-navigator-title-icon{margin-right:0;position:relative;top:4px}.previewr-wrapper .zip-navigator-title-container .zip-navigator-ddicon{position:relative;top:1px}.previewr-wrapper .zip-navigator-title-container.zip-expanded .zip-navigator-title{top:-4px}.previewr-wrapper .zip-navigator-title-container.zip-expanded .zip-navigator-ddicon{top:-1px}.previewr-wrapper .zip-navigator-container{position:absolute;top:0;left:0}.previewr-wrapper .zip-navigator-container.dd-close{display:none}.previewr-wrapper .zip-dd-close{display:none}.previewr-wrapper .list-header{color:#000;width:235px;font-weight:700;background:#fff;padding-left:15px;height:38px;line-height:38px}.previewr-wrapper .list-header:hover{background:#fff}.previewr-wrapper .list-header .folder-nav:hover{text-decoration:underline;cursor:pointer}.previewr-wrapper .list-header .rest-folder{overflow:hidden;text-overflow:ellipsis;max-width:180px;white-space:nowrap}.previewr-wrapper .zip-navigator-dd{width:250px;list-style:none;margin:0;padding:0;box-shadow:0 5px 10px rgba(0,0,0,.36);background:#fff;max-height:250px;overflow-y:auto;overflow-x:hidden}.previewr-wrapper .zip-navigator-dd li{height:35px;line-height:35px;color:#535354;padding-left:15px}.previewr-wrapper .zip-navigator-dd li.key-hover{background:#E0E0E0}.previewr-wrapper .zip-navigator-dd li:hover{cursor:pointer;background:#EEE}.previewr-wrapper .zip-navigator-dd li .foldername{width:150px;height:35px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.previewr-wrapper .zip-navigator-dd li .file-icon{width:21px;line-height:35px}.previewr-wrapper .zip-navigator-dd li .filename{height:35px;width:175px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.previewr-wrapper .zip-navigator-dd li.active{background:#EDE6F0}.previewr-wrapper .zip-navigator-dd li.disable div:hover{cursor:default}.previewr-wrapper .zip-navigator-dd li.disable span:hover{cursor:default}.previewr-wrapper .zip-navigator-dd li.disable:hover{cursor:default;background:#fff}.previewr-wrapper .zip-navigator-dd{display:block}.previewr-wrapper.collapsed .page-navigator .page-label{display:none}.previewr-wrapper.collapsed .nav-handles{display:none}.previewr-wrapper.collapsed.show-control-box .nav-handles{display:inline;float:left}.previewr-wrapper.collapsed.show-control-box .control-box-wrapper{display:block}.previewr-wrapper.expanded.show-control-box .nav-handles{display:inline;float:left}.previewr-wrapper.expanded.show-control-box .control-box-wrapper{display:block}.previewr-wrapper.expanded .toolbar-borderdiv{display:none}.previewr-wrapper.expanded .toolbar-docstyle{left:0}.previewr-wrapper.expanded .doc-title .dot{display:inline-block}.previewr-wrapper.expanded .viewer-wrapper{border:none}.dummy-image-wrapper{position:absolute;top:0;bottom:0;left:0;right:0}.image-viewer{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;background-size:contain;background-position:center center;background-repeat:no-repeat}.image-zoom-wrapper{position:absolute;outline:0}.zip-blue{color:#7BAEF5}.zip-viewer{width:100%;height:100%}.zip-viewer .folder-nav{white-space:nowrap}.zip-viewer>div:first-child{color:#000;position:relative;width:100%;height:100%}.zip-viewer>div:first-child .zip-viewer-helper{height:35px;line-height:35px;padding:0 15px 0 15px;color:#000;border:1px solid #EEE;font-weight:700;width:200px;position:absolute;visibility:hidden;z-index:-1;top:10px;left:10px}.zip-viewer>div:first-child .zip-file-preview{position:absolute;top:0;bottom:0;right:0;left:270px}.zip-viewer>div:first-child .zip-file-list{width:248px;position:absolute;top:10px;left:10px;bottom:10px;overflow:hidden;z-index:21}.zip-viewer>div:first-child .zip-file-list .file-list-disp{border:1px solid #EEE;overflow-y:auto;max-height:90%;border-top:none}.zip-viewer>div:first-child .zip-file-list li,.zip-viewer>div:first-child .zip-file-list ul{list-style:none;padding:0;margin:0}.zip-viewer>div:first-child .zip-file-list li{height:35px;line-height:35px;color:#535354;padding-left:15px}.zip-viewer>div:first-child .zip-file-list li.key-hover{background:#EEE}.zip-viewer>div:first-child .zip-file-list li:hover{cursor:pointer;background:#EEE}.zip-viewer>div:first-child .zip-file-list li .foldername{width:100px;height:35px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.zip-viewer>div:first-child .zip-file-list li .file-icon{width:21px;line-height:35px}.zip-viewer>div:first-child .zip-file-list li .filename{height:35px;width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.zip-viewer>div:first-child .zip-file-list li.active{background:#EDE6F0}.zip-viewer>div:first-child .zip-file-list li.disable div:hover{cursor:default}.zip-viewer>div:first-child .zip-file-list li.disable span:hover{cursor:default}.zip-viewer>div:first-child .zip-file-list li.disable:hover{cursor:default;background:0 0}.zip-viewer>div:first-child .zip-file-list .folder-nav:hover{text-decoration:underline;cursor:pointer}.zip-viewer>div:first-child .zip-file-list .list-header{height:35px;line-height:35px;padding:0 15px 0 15px;color:#000;border:1px solid #EEE;font-weight:700;width:216px;overflow:hidden}.zip-viewer>div:first-child .zip-file-list .list-header .rest-folder{overflow:hidden;text-overflow:ellipsis;max-width:180px;white-space:nowrap}.zip-viewer>div:first-child .zip-file-list.file-list-off{display:none}.zip-viewer>div:first-child .zip-file-preview.file-list-off{left:0}.sheet-viewer{width:100%;height:100%}.sheet-viewer .sheet-tabs{position:absolute;height:35px;background:#fff;bottom:0;overflow:hidden;z-index:10000;border-top:2px solid #999;width:100%}.sheet-viewer .sheet-tabs .sheet-tabs-nav{width:20px;height:50px;color:#1293FF;font-size:35px}.sheet-viewer .sheet-tabs .sheet-tabs-nav.nl::before{content:"\\e058"}.sheet-viewer .sheet-tabs .sheet-tabs-nav.nr::before{content:"\\e057"}.sheet-viewer .sheet-tabs .sheet-tabs-nav.disable{color:#d2d2d2}.sheet-viewer .sheet-tabs .sheet-innerdiv{overflow:hidden;height:50px;padding-top:5px;white-space:nowrap}.sheet-viewer .sheet-tabs .sheet-innerdiv .sheet-innerdiv-container{height:50px;white-space:nowrap;overflow:hidden}.sheet-viewer .sheet-tabs .sheet-innerdiv .sheet-separator{color:#d2d2d2;float:left;margin-top:4px}.sheet-viewer .sheet-tabs .sheet-innerdiv .sheet-tab-container{display:inline-block}.sheet-viewer .sheet-tabs .sheet-innerdiv .sheet-tab{float:left;color:#999;padding:5px 5px 5px 5px;margin-left:10px;margin-right:10px;max-width:110px;text-overflow:ellipsis;overflow:hidden}.sheet-viewer .sheet-tabs .sheet-innerdiv .sheet-tab.active{color:#1293FF;font-weight:700}.sheet-viewer .sheet-tabs .sheet-innerdiv:hover{cursor:pointer}.sheet-viewer .sheet-tabs .sheet-tabs-nav.nl{float:left}.sheet-viewer .sheet-tabs .sheet-tabs-nav.nr{float:right}.doc-viewer{width:100%;height:100%;outline:0;text-rendering:optimizeSpeed}.doc-viewer li,.doc-viewer ul{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;list-style:none;text-rendering:optimizeSpeed}.doc-viewer .page-list{width:100%;height:100%;overflow:auto;outline:0}.doc-viewer .page-list.sheets-enabled{width:100%;position:absolute;top:0;bottom:36px;left:0;overflow:auto;outline:0}.doc-viewer .page-list .page-html{width:100%;height:100%;overflow:auto}.doc-viewer .page-list .page-css{display:none}.doc-viewer .page-list .pf{position:relative;background-color:#fff;overflow:hidden;border:0;margin:0 auto;border-collapse:separate}.doc-viewer .page-list .page-outer-wrapper{position:relative;background-color:#fff;overflow:hidden;border:0;margin:0 auto;border-collapse:separate;border-bottom:3px solid #e4e4e4}.doc-viewer .page-list .page-inner-wrapper{position:absolute;border:0;padding:0;margin:0;top:0;left:0;overflow:hidden;display:block;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;transform-origin:0 0}.doc-viewer .page-list .bi{position:absolute;border:0;margin:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.doc-viewer .page-list .c{position:absolute;border:0;padding:0;margin:0;overflow:hidden;display:block}.doc-viewer .page-list .t{position:absolute;white-space:pre;-webkit-transform-origin:0 100%;-moz-transform-origin:0 100%;transform-origin:0 100%;unicode-bidi:bidi-override;-moz-font-feature-settings:"liga" 0}.doc-viewer .page-list .t:after{content:\'\'}.doc-viewer .page-list .t:before{content:\'\';display:inline-block}.doc-viewer .page-list .t span{position:relative;unicode-bidi:bidi-override}.doc-viewer .page-list ._{display:inline-block;color:transparent;z-index:-1}.doc-viewer .page-list .pi{display:none}.doc-viewer .page-list .d{position:absolute;-webkit-transform-origin:0 100%;-moz-transform-origin:0 100%;transform-origin:0 100%}.doc-viewer .page-list .it{border:none;background-color:rgba(255,255,255,0)}.doc-viewer .page-list .ir:hover{cursor:pointer}.doc-viewer .page-list a.l:hover{cursor:pointer}';a("./../../../jarvis/node_modules/cssify")(d,void 0,"/var/builds/workspace/59200-v3-package/BUILD_CONTAINER/container/label/DOCKER-LOW/app_root/artifacts/css/main.css"),b.exports=d},{"./../../../jarvis/node_modules/cssify":56}],2:[function(a,b,c){var d={str_bug_mail_name:"Document Preview Feedback",str_bug_report_body:"Thank you for testing the new Document Preview feature. <br> <br> If you notice a quality problem, please attach screenshots with this email.<br> For any other feedback, please describe the problem in this email.<br> <br> Thank you, <br> Document Preview Team <br>",str_bug_subj:"Document Preview Bug Report",str_bug_title:"File a Bug",str_doc_failed:"Unable to generate preview.",str_doc_loading:"Generating preview",str_download:"Download",str_download_zip:"Download Zip",str_from:"From:",str_goback_message:"Back to Message",str_hover_close:"Close Preview",str_hover_download:"Download",str_hover_expand:"Expand Preview",str_hover_fullscreen:"Full Screen",str_hover_next_attachment:"Next Attachment",str_hover_pagenavigator:"Page",str_hover_prev_attachment:"Previous Attachment",str_hover_zoom_in:"Zoom In",str_hover_zoom_out:"Zoom Out",str_page_failed:"Unable to load this page.",str_password_not_viewable:"The document is password protected.",str_retry:"Retry",str_sheets_scroll_left:"Scroll Left",str_sheets_scroll_right:"Scroll Right",str_unsupported_filetype:"This file can't be viewed here.",str_zip_click_to_preview_part1:"Preview zip files within Mail.",str_zip_click_to_preview_part2:"Select a file from the zip file drawer on the left",str_zip_loading:"Extracting",last:null};b.exports=d},{}],3:[function(a,b,c){"use strict";var d=a("../constants/previewr_core_constants.js").mail.actions;b.exports={resetPasswordView:function(a,b){a.dispatch(d.PREVIEWR_CORE_RESET_PASSWORD_VIEW,b)},deleteDoc:function(a,b){a.dispatch(d.PREVIEWR_CORE_DELETE_DOC,b)},deletePage:function(a,b){a.dispatch(d.PREVIEWR_CORE_DELETE_PAGE,b)},setScrollPercent:function(a,b){a.dispatch(d.PREVIEWR_CORE_SET_SCROLL_PERCENT,b)},incrementDocCount:function(a,b){a.dispatch(d.PREVIEWR_CORE_OPEN_DOCUMENT,b)},decrementDocCount:function(a,b){a.dispatch(d.PREVIEWR_CORE_CLOSE_DOCUMENT,b)}}},{"../constants/previewr_core_constants.js":35}],4:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../artifacts/lang.js"),g=a("../../actions/previewr_core_actions.js"),h=a("StatService"),i=a("context-mixin");d=e.createClass({displayName:"DocFailed",mixins:[i],retryDoc:function(){this.context.executeAction(g.deleteDoc,this.props.docId)},statFailure:function(){var a,b,c=this,d=c.props.filetype,e=c.props.mimetype;a=c.props.docData?c.props.docData.docError?c.props.docData.docError:c.props.docData.info?c.props.docData.info.dimension?0===c.props.docData.info.num_pages?"numPgZero":c.props.docData.info.num_pages?"UnknownErr":"PgNull":"DimNull":"InfoNull":"DocDataNull",b={failure_type:"document",filetype:d,mimetype:e,docError:a},h.stat({name:"previewr_user_perceived_failure",tags:b})},onDownloadClick:function(a){this.props.callbacksObj.downloadAtt(a),h.stat({name:"previewr_tb_click",tags:{statKey:"download",downloadType:"failed"}})},componentDidMount:function(){this.statFailure()},render:function(){var a=this.props.partId?f.str_download_zip:f.str_download;return e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-alert icon"})),e.createElement("div",{className:"message"},f.str_doc_failed),e.createElement("div",{className:"message"},e.createElement("span",{className:"download-att",onClick:this.onDownloadClick},a),e.createElement("span",{className:"retry-preview",onClick:this.retryDoc},f.str_retry)))}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"../../actions/previewr_core_actions.js":3,StatService:"StatService","context-mixin":"context-mixin","react/addons":"react/addons"}],5:[function(a,b,c){"use strict";var d=a("../../constants/previewr_core_constants.js").mail,e=d.docStatus,f={};f[e.DOC_READY_FOR_VIEW]=a("./doc_ready.jsx"),f[e.DOC_EXCEL_TABS]=a("./doc_sheets_viewer.jsx"),f[e.DOC_NOT_READY_FOR_VIEW]=a("./doc_not_ready.jsx"),f[e.DOC_CONVERSION_FAILED]=a("./doc_conversion_failed.jsx"),f[e.DOC_PASSWORD_VIEWABLE]=a("./doc_password_protected.jsx"),f[e.DOC_PASSWORD_WRONG]=a("./doc_password_protected.jsx"),b.exports=f},{"../../constants/previewr_core_constants.js":35,"./doc_conversion_failed.jsx":4,"./doc_not_ready.jsx":6,"./doc_password_protected.jsx":7,"./doc_ready.jsx":8,"./doc_sheets_viewer.jsx":9}],6:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../artifacts/lang.js");d=e.createClass({displayName:"DocLoading",propTypes:{callbacksObj:e.PropTypes.object.isRequired},getInitialState:function(){var a=this;return a.props.partId?a.props.callbacksObj.fetchAction({reqPageNumber:1,docId:a.props.docId,partId:a.props.partId}):a.props.callbacksObj.fetchAction({reqPageNumber:1,docId:a.props.docId}),null},render:function(){return e.createElement("div",{className:"viewer-message delay-visiblity"},e.createElement("div",{className:"message-icon"},e.createElement("div",{className:"msg-loading s-loader"})),e.createElement("div",{className:"message"},f.str_doc_loading))}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],7:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("lodash"),g=a("../../constants/previewr_core_constants.js").mail,h=a("../../actions/previewr_core_actions.js"),i=a("context-mixin"),j=a("../../../../../artifacts/lang.js");d=e.createClass({displayName:"DocPasswordViewable",mixins:[i],propTypes:{callbacksObj:e.PropTypes.object.isRequired},getInitialState:function(){return this.loadingState=!1,null},sendPassword:function(){var a=this,b=a.props.docData.docStatus===g.docStatus.DOC_PASSWORD_WRONG,c=a.refs.pwdInput.getDOMNode().value;f.isEqual(f.trim(c),"")||a.loadingState||(a.loadingState=!0,b&&a.context.executeAction(h.resetPasswordView,a.props.docId),a.setState(),a.props.fetchAction({reqPageNumber:1,pwd:c}))},updatePassword:function(a){13===a.keyCode&&this.sendPassword()},shouldComponentUpdate:function(a){var b=this,c=a.docData.docStatus===g.docStatus.DOC_PASSWORD_WRONG;return c&&(b.loadingState=!1),!0},render:function(){return e.createElement("div",{className:"viewer-message pwd-protected"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-encrypt icon",style:{marginLeft:"10px"}})),e.createElement("div",{className:"message"},j.str_password_not_viewable))}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"../../actions/previewr_core_actions.js":3,"../../constants/previewr_core_constants.js":35,"context-mixin":"context-mixin",lodash:"lodash","react/addons":"react/addons"}],8:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("./page_list.jsx"),g=a("StatService"),h=a("context-mixin"),i=a("../../../mixins/TimeoutMixin"),j=a("../../actions/previewr_core_actions.js");d=e.createClass({displayName:"DocReady",mixins:[h,i],propTypes:{docData:e.PropTypes.object.isRequired,callbacksObj:e.PropTypes.object.isRequired,pageTopMargin:e.PropTypes.number,pageBottomMargin:e.PropTypes.number,pageBorderBottom:e.PropTypes.number,zoomType:e.PropTypes.string,filetype:e.PropTypes.string},getDefaultProps:function(){return{pageTopMargin:13,pageBottomMargin:0,pageBorderBottom:3}},statSuccess:function(){var a=this,b=a.props.filetype,c=a.props.mimetype;g.stat({name:"previewr_user_perceived_success",tags:{failure_type:"document",filetype:b,mimetype:c}})},componentDidMount:function(){var a=this;a.statSuccess(),a.addSetTimeout(setTimeout(function(){a.context.executeAction(j.incrementDocCount,a.props.docId)},0))},componentWillUnmount:function(){var a=this;a.context.executeAction(j.decrementDocCount,a.props.docId)},render:function(){var a=this;return e.createElement(f,{callbacksObj:a.props.callbacksObj,docData:a.props.docData,filetype:a.props.filetype,mimetype:a.props.mimetype,docId:a.props.docId,partId:a.props.partId,pageTopMargin:a.props.pageTopMargin,pageBottomMargin:a.props.pageBottomMargin,pageBorderBottom:a.props.pageBorderBottom,extraBufferItems:2,zoomType:a.props.zoomType})}}),b.exports=d},{"../../../mixins/TimeoutMixin":39,"../../actions/previewr_core_actions.js":3,"./page_list.jsx":12,StatService:"StatService","context-mixin":"context-mixin","react/addons":"react/addons"}],9:[function(a,b,c){"use strict";var d,e=a("lodash"),f=a("react/addons"),g=a("./page_list.jsx"),h=a("../../../../../artifacts/lang.js"),i=a("../../../mixins/TimeoutMixin.js");d=f.createClass({displayName:"SheetsViewer",propTypes:{callbacksObj:f.PropTypes.object.isRequired},mixins:[i],getInitialState:function(){var a,b,c,d=this,f=d.props.docData.info.sheets_info;d.sheetInfo=[],d.activeSheet=0,d.scrollJumpVal=250,d.actualPageCount=this.props.docData.info.actualPageCount||this.props.docData.info.num_pages,this.props.docData.info.actualPageCount=d.actualPageCount;for(a in f)f.hasOwnProperty(a)&&(b=f[a].split("-"),c={},c.name=a,c.start_page=parseInt(b[0]),c.end_page=parseInt(b[1]),d.sheetInfo.push(c));return d.sheetInfo=e.map(e.sortByAll(d.sheetInfo,"start_page")),null},componentDidMount:function(){this.setState({})},activateSheet:function(a){this.activeSheet=a,this.setState({})},getSheetTabsMarkUp:function(){var a,b=this,c=[],d=0;for(d=0;d<b.sheetInfo.length;d++)a="sheet-tab",d===b.activeSheet&&(a+=" active"),d!==b.sheetInfo.length-1?c.push(f.createElement("span",{className:"sheet-tab-container"},f.createElement("div",{className:a,onClick:b.activateSheet.bind(null,d),title:b.sheetInfo[d].name},b.sheetInfo[d].name),f.createElement("div",{className:"sheet-separator"},"|"))):c.push(f.createElement("span",{className:"sheet-tab-container"},f.createElement("div",{className:a,onClick:b.activateSheet.bind(null,d),title:b.sheetInfo[d].name},b.sheetInfo[d].name)));return c},hasSheetsOverFlown:function(){var a=this,b=a.isMounted()&&a.getDOMNode(),c=b&&b.querySelector(".sheet-innerdiv-container");if(!b||!c)return void a.addSetTimeout(setTimeout(function(){a.setState({})},200));if(c.scrollWidth!==c.clientWidth)return c.scrollLeft<10?"right":c.scrollLeft+c.offsetWidth>=c.scrollWidth?"left":"both"},scrollL:function(){var a,b=this,c=b.getDOMNode().querySelector(".sheet-innerdiv-container");a=c.scrollLeft-b.scrollJumpVal,50>a&&(a=0),c.scrollLeft=a,b.setState({})},scrollR:function(){var a,b=this,c=b.getDOMNode().querySelector(".sheet-innerdiv-container"),d=c.offsetWidth;a=c.scrollLeft+b.scrollJumpVal,d+=b.scrollPos,d>c.scrollWidth-100&&(a=c.scrollWidth),c.scrollLeft=a,b.setState({})},render:function(){var a,b,c,d=this,e=d.getSheetTabsMarkUp(),i=NeoConfig.isRTL?"rtl":"ltr";switch(c=d.sheetInfo[d.activeSheet].name+this.props.docId,this.props.docData.info.num_pages=d.sheetInfo[d.activeSheet].end_page-d.sheetInfo[d.activeSheet].start_page+1,d.hasSheetsOverFlown()){case"left":a=f.createElement("div",{className:"sheet-tabs-nav icon nl",onClick:d.scrollL,title:h.str_sheets_scroll_left}),b=f.createElement("div",{className:"sheet-tabs-nav disable icon nr",onClick:d.scrollR,title:h.str_sheets_scroll_right});break;case"right":a=f.createElement("div",{className:"sheet-tabs-nav icon disable nl",onClick:d.scrollL,title:h.str_sheets_scroll_left}),b=f.createElement("div",{className:"sheet-tabs-nav icon nr",onClick:d.scrollR,title:h.str_sheets_scroll_right});break;case"both":a=f.createElement("div",{className:"sheet-tabs-nav icon nl",onClick:d.scrollL,title:h.str_sheets_scroll_left}),b=f.createElement("div",{className:"sheet-tabs-nav icon nr",onClick:d.scrollR,title:h.str_sheets_scroll_right})}return f.createElement("div",{className:"sheet-viewer delay-visiblity"},f.createElement("div",{className:"sheet-tabs",dir:i},a,b,f.createElement("div",{className:"sheet-innerdiv"},f.createElement("div",{className:"sheet-innerdiv-container"},e))),f.createElement(g,{key:d.activeSheet,callbacksObj:d.props.callbacksObj,docData:d.props.docData,filetype:d.props.filetype,mimetype:d.props.mimetype,docId:c,partId:d.props.partId,sheetInfo:{startpage:d.sheetInfo[d.activeSheet].start_page,actualPageCount:d.actualPageCount,name:d.sheetInfo[d.activeSheet].name},pageTopMargin:d.props.pageTopMargin,pageBottomMargin:d.props.pageBottomMargin,pageBorderBottom:d.props.pageBorderBottom,extraBufferItems:5,zoomType:d.props.zoomType}))}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"../../../mixins/TimeoutMixin.js":39,"./page_list.jsx":12,lodash:"lodash","react/addons":"react/addons"}],10:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../stores/previewr_core_document_store.js"),g=a("../../constants/previewr_core_constants.js").mail,h=a("../../../mixins/StoreMixin.js"),i=a("StatService"),j=a("context-mixin"),k=a("./doc_factory.js"),l=18e3,m=a("lodash");d=e.createClass({displayName:"DocViewer",mixins:[j,h],getStores:function(){return{PreviewrDocStore:this.context.getStore(f)}},startTime:null,getInitialState:function(){return this.startTime=(new Date).getTime(),{}},shouldComponentUpdate:function(){return this.getDOMNode().clientWidth>10},componentDidMount:function(){var a=this,b=a.props.docId,c=a.stores.PreviewrDocStore.getDocStatus(b);c&&a.startTime&&(a.statLatency((new Date).getTime()-a.startTime,"cached_"+c),a.startTime=null)},componentDidUpdate:function(){var a=this,b=a.props.docId,c=a.stores.PreviewrDocStore.getDocStatus(b);c&&a.startTime&&(a.statLatency((new Date).getTime()-a.startTime,c),a.startTime=null),c||a.startTime||(a.startTime=(new Date).getTime())},componentWillUnmount:function(){var a=this;a.startTime=null},propTypes:{docData:e.PropTypes.object,callbacksObj:e.PropTypes.object.isRequired,zoomType:e.PropTypes.string},getDefaultProps:function(){return{docData:null}},statLatency:function(a,b){var c=this,d=c.props.docId,e=c.stores.PreviewrDocStore.getDocData(d),f="",g="previewr_first_page_latency";a>l&&(g="previewr_first_page_high_latency"),e.info&&(f=e.info.conversion_type+e.handler),i.stat({name:g,unit:"ms",type:"duration",dataum:a,
tags:{docStatus:b,conversionType:f,filetype:this.props.filetype}})},render:function(){var a=this,b=a.props.docId,c=a.props.filetype,d=a.props.mimetype,f=a.stores.PreviewrDocStore.getDocStatus(b)||g.docStatus.DOC_NOT_READY_FOR_VIEW,h=a.stores.PreviewrDocStore.getDocData(b);return f===g.docStatus.DOC_NOT_READY_FOR_VIEW||h&&h.info&&h.info.dimension&&h.info.num_pages&&h.info.num_pages>0||(f=g.docStatus.DOC_CONVERSION_FAILED),a.props.isSheetsViewEnabled&&f===g.docStatus.DOC_READY_FOR_VIEW&&h.info.sheets_info&&m.size(h.info.sheets_info)>1&&(f=g.docStatus.DOC_EXCEL_TABS),e.createElement("div",{className:"doc-viewer",key:b},e.createElement(k[f],{callbacksObj:a.props.callbacksObj,docData:h,filetype:c,mimetype:d,docId:b,pageTopMargin:13,pageBottomMargin:0,pageBorderBottom:3,zoomType:a.props.zoomType,partId:a.props.partId}))}}),b.exports=d},{"../../../mixins/StoreMixin.js":38,"../../constants/previewr_core_constants.js":35,"../../stores/previewr_core_document_store.js":36,"./doc_factory.js":5,StatService:"StatService","context-mixin":"context-mixin",lodash:"lodash","react/addons":"react/addons"}],11:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("lodash"),g=5,h=15;d=e.createClass({displayName:"InfiniteScroll",getInitialState:function(){var a=this.props,b=a.items.length*a.itemHeight,c=Math.floor(b/a.itemHeight);return{loading:!1,scrollTop:0,loadThreshold:a.loadThreshold||g,items:a.items,defaultItemsPerPage:a.defaultItemsPerPage||h,extraBufferItems:a.extraBufferItems||0,onScrollCbk:a.onScrollCbk||null,hasMoreItems:a.hasMoreItems,itemHeight:a.itemHeight,itemHeightArr:a.itemHeightArr||null,itemsPerPage:c,visibleStart:0,visibleEnd:c,displayStart:0,displayEnd:Math.min(2*c,a.items.length)}},isScrollUpdate:!1,componentWillReceiveProps:function(a){var b=a.itemHeight,c=a.items.length,d=this.getScrollState(b,c);this.setState(f.merge({loading:!1,items:a.items,hasMoreItems:a.hasMoreItems},d))},componentWillMount:function(){var a=this.state.defaultItemsPerPage;this.setState({itemsPerPage:a,visibleEnd:a,displayEnd:Math.min(2*a,this.state.items.length)})},componentDidMount:function(){this._setElementsDisplayedPerPage()},componentDidUpdate:function(){var a=this.refs.scrollable.getDOMNode().offsetHeight;0===this.state.itemsPerPage&&a>0&&this._setElementsDisplayedPerPage()},_setElementsDisplayedPerPage:function(){var a=this.refs.scrollable.getDOMNode().offsetHeight,b=Math.floor(a/this.state.itemHeight)+this.state.extraBufferItems;b>10&&(b=1),this.setState({itemsPerPage:b,visibleEnd:b,displayEnd:Math.min(2*b,this.state.items.length)})},_getVisibleStart:function(a){var b,c=this.state,d=c.itemHeight,e=c.itemHeightArr,f=c.items.length;if(!e)return Math.floor(a/d);for(b=0;f>b;b++)if(a-=e[b],0>a)return b},getScrollState:function(a,b){var c=this.state,d=this.refs.scrollable.getDOMNode().scrollTop,e=c.itemsPerPage,f=this._getVisibleStart(d),g=Math.min(f+e,b),h=Math.max(0,f-e),i=Math.min(g+e,b);return{visibleStart:f,visibleEnd:g,displayStart:h,displayEnd:i,scrollTop:d}},onScroll:function(a){var b=this.state,c=b.itemHeight,d=this.state.onScrollCbk,e=b.items.length;d&&d(a),this.isScrollUpdate=!0,this.setState(this.getScrollState(c,e),function(){this.isScrollUpdate=!1,this.loadMore()})},_shouldLoad:function(){var a=this.state,b=a.items.length,c=a.displayStart;return!a.loading&&a.hasMoreItems&&b-c<a.loadThreshold*a.itemsPerPage},loadMore:function(){this._shouldLoad()&&(this.setState({loading:!0}),this.props.loadMore())},getSpacerHeight:function(a,b){var c,d,e=0,f=this.state,g=f.itemHeight,h=f.itemHeightArr;if(d=b-a,0>=d)return 0;if(!h)return g*d;for(c=a;b>c;c++)e+=h[c];return e},render:function(){var a,b,c,d=[],f=this.props,g=this.state,h=g.itemHeight,i=g.itemHeightArr,j=g.items,k=g.displayStart,l=g.displayEnd,m=this.getSpacerHeight(0,k),n=this.getSpacerHeight(l,j.length),o=this.props.LoadMoreComponent;for(d.push(e.createElement("li",{key:"top",line:"top",style:{height:m}})),a=k;l>a;a++)b=j[a],b.props&&(b.props.isScrollUpdate=this.isScrollUpdate),i&&(h=i[a]),c=e.createElement("li",{key:"row-"+a,className:f.itemClass,style:{height:h}},e.createElement(b.descriptor,b.props)),d.push(c);return d.push(e.createElement("li",{key:"bottom",line:"bottom",style:{height:n}})),this.state.loading&&this.props.LoadMoreComponent&&d.push(e.createElement("li",{key:"loading"},e.createElement(o,null))),e.createElement("div",{className:this.props.className,ref:"scrollable",onScroll:this.onScroll},e.createElement("ul",{className:"Reset"},d))}}),b.exports=d},{lodash:"lodash","react/addons":"react/addons"}],12:[function(a,b,c){"use strict";var d,e,f=a("react/addons"),g=a("../../constants/previewr_core_constants.js").mail,h=a("../toolbarComponents/page_navigator.jsx"),i=a("./pages/page_factory.js"),j=a("../../actions/previewr_core_actions.js"),k=a("./pages/page_css.jsx"),l=a("context-mixin"),m=a("./list.jsx"),n=a("../../../mixins/TimeoutMixin.js");!function(){var a,b,c=["transform","WebkitTransform","MozTransform","OTransform"];for(a=0,b=c.length;b>a;a+=1)if("undefined"!=typeof document.body.style[c[a]]){e=c[a];break}}(),d=f.createClass({displayName:"PageList",mixins:[l,n],pageScrollPositionsMap:{},totalPagesHeight:0,scrollPercent:0,currentPage:1,layoutMode:null,propTypes:{callbacksObj:f.PropTypes.object.isRequired,docData:f.PropTypes.object.isRequired,pageTopMargin:f.PropTypes.number,pageBottomMargin:f.PropTypes.number,pageBorderBottom:f.PropTypes.number,filetype:f.PropTypes.string,zoomType:f.PropTypes.string},getDefaultProps:function(){return{pageTopMargin:13,pageBottomMargin:0,pageBorderBottom:3}},getInitialState:function(){var a=this,b=a.props;return a.setPagePositionsMap(),a.currentPage=b.docData.scroll_percent&&b.docData.scroll_percent.page||1,{userZoomFactor:1,zoomFitFactor:null,scrollPercent:b.scrollPercent}},getZoomFitFactor:function(){var a,b,c,d=this,e=d.props,f=e.zoomType,h=d.getDOMNode(),i=h.clientWidth,j=h.clientHeight-d.getPageMarginHeights().top,k=e.docData.info.dimension;return h.style.overflowY="scroll",b=h.offsetWidth-h.clientWidth,i-=b,h.style.overflowY="auto",f===g.zoomType.PRESENTATION?(c=i*k.h/k.w,a=c>j?j/k.h:i/k.w):a=i/k.w,a},zoomCbk:function(a){var b,c=this,d=c.state;d.userZoomFactor&&(b=d.userZoomFactor+a,5>=b&&b>=.1&&c.setState({userZoomFactor:b}))},getPageMarginHeights:function(){var a=this.props;return{top:a.pageTopMargin,bottom:a.pageBottomMargin+a.pageBorderBottom}},getPageNumber:function(a){var b,c,d=this,e=this.state,f=null,g=d.props.docData.info.num_pages,h=d.getPageMarginHeights(),i=h.top+h.bottom,j=e.zoomFitFactor*e.userZoomFactor;for(c=1;g>=c;c++)if(c!==g){if(b=d.pageScrollPositionsMap["p"+(c+1)].scroll*j+i*c,b>=a){f=c;break}}else f=c;return f},jumpToPage:function(a){var b,c,d,e,f=this,g=f.props.docData.info.num_pages,h=f.state.zoomFitFactor*f.state.userZoomFactor;a>=1&&g>=a&&(b=f.getPageMarginHeights(),c=b.top+b.bottom,d=f.pageScrollPositionsMap["p"+a].jump*h+c*a-b.bottom,e=f.getDOMNode().querySelector(".page-html"),e.scrollTop=d,f.scrollPercent=f.getScrollPercent())},setPagePositionsMap:function(){var a,b,c=this,d=c.props.docData.info.num_pages,e=c.props.docData.info.dimension,f=e.h,g=c.props.docData.info.exceptions,h=0;for(a=1;d>=a;a++)c.pageScrollPositionsMap["p"+a]={},b=f,g&&g["p"+a]&&(b=g["p"+a].h),c.pageScrollPositionsMap["p"+a].scroll=h-.2*b,c.pageScrollPositionsMap["p"+a].jump=h,h+=b;c.totalPagesHeight=h},getScrollPercent:function(){var a=this,b=a.getPageMarginHeights(),c=b.top+b.bottom,d=c*a.props.docData.info.num_pages,e=a.getDOMNode().querySelector(".page-html"),f=e.scrollTop,g=e.scrollHeight;return(f-(a.currentPage*c-b.bottom))/(g-d)},adjustScrollTop:function(){var a,b,c=this,d=c.getPageMarginHeights(),e=d.top+d.bottom,f=e*c.props.docData.info.num_pages,g=c.getDOMNode(),h=c.scrollPercent||c.props.docData.scroll_percent&&c.props.docData.scroll_percent.percent||0;c.scrollPercent=h,g&&(a=g.querySelector(".page-html"),b=a.scrollHeight,a.scrollTop=(b-f)*h+(c.currentPage*e-d.bottom),a.scrollLeft=(a.scrollWidth-a.clientWidth)/2)},handleScrollChange:function(a){var b=this,c=a.target.scrollTop,d=b.getPageNumber(c),e=b.currentPage;b.scrollPercent=b.getScrollPercent(),e!==d&&(b.currentPage=d,b.pageNavigator&&b.pageNavigator.props.cbkObj.listener&&b.pageNavigator.props.cbkObj.listener(d))},handleKeyUp:function(a){var b=this;if(a.ctrlKey)switch(a.keyCode){case 107:case 187:b.zoomCbk(.1),a.preventDefault();break;case 109:case 189:b.zoomCbk(-.1),a.preventDefault()}else b.pageNavigator&&b.pageNavigator.props.cbkObj.onKeyUp&&b.pageNavigator.props.cbkObj.onKeyUp(a)},handleClick:function(a){var b=this,c=a.nativeEvent.target,d=c.parentNode.getAttribute("data-internal-link");d&&(d=JSON.parse(d),b.jumpToPage(d[0]))},componentWillUnmount:function(){var a={docId:this.props.docId,scrollPercent:this.scrollPercent,currentPage:this.currentPage};this.context.executeAction(j.setScrollPercent,a)},componentDidMount:function(){this.addToolbarItems(),this.componentDidMountOrDidUpdate()},addToolbarItems:function(){var a=this,b=a.props,c=b.callbacksObj.addToolbarItem,d=b.docData;a.props.sheetInfo||(a.pageNavigator=f.createElement(h,{totalPages:d.info.num_pages,currentPage:a.currentPage,cbkObj:{listener:null,onKeyUp:null,jumpToPage:a.jumpToPage},key:a.props.sheetInfo&&a.props.sheetInfo.name||"default"}),c(a.pageNavigator,{pos:4})),a.props.callbacksObj.zoomCbk=a.zoomCbk,a.props.callbacksObj.refreshZoomControls&&a.props.callbacksObj.refreshZoomControls()},componentDidUpdate:function(){this.componentDidMountOrDidUpdate()},adjustZoomFitFactor:function(a){var b=this,c=b.props,d={zoomFitFactor:b.getZoomFitFactor(),userZoomFactor:1};b.setState(d),b.layoutMode=c.zoomType+a.clientWidth},componentDidMountOrDidUpdate:function(){var a=this,b=a.props,c=a.getDOMNode(),d=a.layoutMode!==b.zoomType+c.clientWidth;return a.addSetTimeout(setTimeout(function(){c.focus()},100)),d?void(a.getZoomFitFactor()<0?a.addSetTimeout(setTimeout(function(){a.adjustZoomFitFactor(c)},100)):a.adjustZoomFitFactor(c)):void a.adjustScrollTop()},getItemHeightForList:function(a,b,c){return a*b.h+c.top+c.bottom},render:function(){var a,b,c,d,h,j,l,n,o=this,p=o.state.zoomFitFactor*o.state.userZoomFactor,q=o.props,r=q.docData,s=r.info.num_pages,t=r.info.dimension,u=r.info.exceptions,v=o.getPageMarginHeights(),w=[],x=[],y=0,z=o.props.sheetInfo,A=[];for(z&&(y=o.props.sheetInfo.startpage-1),a=1;s>=a;a++)j=a+y,b=r.pages["page"+j],c=b&&b.statuscode||g.pageStatus.PAGE_CONVERTING,h=u["p"+j]?u["p"+j].h:t.h,d=u["p"+j]?u["p"+j].w:t.w,A.push(o.getItemHeightForList(p,{h:h,w:d},v)),w.push({descriptor:i[c],props:{docId:o.props.docId,partId:o.props.partId,sheetInfo:o.props.sheetInfo,filetype:o.props.filetype,mimetype:o.props.mimetype,pageNo:a,pageObj:b,pageCount:s,callbacksObj:o.props.callbacksObj,scale:p,width:p*d,height:p*h,transformProp:e,hpwd:r.info.hpwd}}),n=b&&b.css?1:2,x.push(f.createElement(k,{pageObj:b,dummyProp:n}));return z&&"SAVE"===r.info.conversion_type&&x.push(f.createElement(k,{pageObj:r.pages.page1})),o.layoutMode?(l="page-list",o.props.sheetInfo&&(l+=" sheets-enabled"),f.createElement("div",{className:l,tabIndex:"0",onClick:o.handleClick,onKeyDown:o.handleKeyUp},f.createElement("div",{className:"page-css"},x),f.createElement(m,{className:"page-html",itemClass:"pageli",defaultItemsPerPage:1,extraBufferItems:q.extraBufferItems,items:w,onScrollCbk:o.handleScrollChange,hasMoreItems:!1,key:Math.max.apply(null,A),itemHeight:Math.max.apply(null,A),itemHeightArr:A}))):f.createElement("div",{className:"page-list",tabIndex:"0"},f.createElement("div",{className:"page-css"},x))}}),b.exports=d},{"../../../mixins/TimeoutMixin.js":39,"../../actions/previewr_core_actions.js":3,"../../constants/previewr_core_constants.js":35,"../toolbarComponents/page_navigator.jsx":21,"./list.jsx":11,"./pages/page_css.jsx":15,"./pages/page_factory.js":16,"context-mixin":"context-mixin","react/addons":"react/addons"}],13:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../../artifacts/lang.js"),g=a("context-mixin"),h=a("StatService"),i=a("../../../actions/previewr_core_actions.js");d=e.createClass({displayName:"PageConvFailed",propTypes:{width:e.PropTypes.number.isRequired,height:e.PropTypes.number.isRequired,filetype:e.PropTypes.string,pageNo:e.PropTypes.number.isRequired},mixins:[g],retryPage:function(){var a=this;a.context.executeAction(i.deletePage,{docId:a.props.docId,pageNo:a.props.pageNo})},statFailure:function(){var a=this,b=a.props.filetype,c=a.props.mimetype,d=a.props.pageObj;d.isFStatRecorded||(h.stat({name:"previewr_user_perceived_failure",tags:{failure_type:"page",filetype:b,mimetype:c}}),d.isFStatRecorded=!0)},componentDidMount:function(){this.statFailure()},render:function(){var a,b="pf"+this.props.pageNo;return a={width:this.props.width,height:this.props.height},e.createElement("div",{className:"pf",style:a,id:b},e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-alert icon"})),e.createElement("div",{className:"message"},f.str_page_failed),e.createElement("div",{className:"message retry-preview",onClick:this.retryPage},f.str_retry)))}}),b.exports=d},{"../../../../../../artifacts/lang.js":2,"../../../actions/previewr_core_actions.js":3,StatService:"StatService","context-mixin":"context-mixin","react/addons":"react/addons"}],14:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../constants/previewr_core_constants.js").mail,g=a("../../../../mixins/TimeoutMixin.js");d=e.createClass({displayName:"PageLoading",propTypes:{width:e.PropTypes.number.isRequired,height:e.PropTypes.number.isRequired,isScrollUpdate:e.PropTypes.bool.isRequired,callbacksObj:e.PropTypes.object.isRequired,pageNo:e.PropTypes.number.isRequired},mixins:[g],fetchTimeStamp:null,componentWillUnmount:function(){this.fetchTimeStamp=null},componentDidMount:function(){this.fetchPage()},componentDidUpdate:function(){var a,b=this,c=(new Date).getTime()-b.fetchTimeStamp,d=f.thresholdObj.RETRY_DELAY;b.props.isScrollUpdate||(c>d?b.fetchPage():(a=d-c,b.addSetTimeout(setTimeout(function(){b.isMounted()&&b.fetchPage()},a))))},fetchPage:function(){var a=this,b={};this.fetchTimeStamp=(new Date).getTime(),b.docId=this.props.docId,b.reqPageNumber=this.props.pageNo,b.pageCount=this.props.pageCount,a.props.hpwd&&(b.hpwd=a.props.hpwd),a.props.partId&&(b.partId=a.props.partId),a.props.sheetInfo&&(b.sheetInfo=a.props.sheetInfo),this.props.callbacksObj.fetchAction(b)},render:function(){var a,b="pf"+this.props.pageNo;return a={width:this.props.width,height:this.props.height},e.createElement("div",{className:"pf",style:a,id:b},e.createElement("div",{className:"viewer-message delay-visiblity"},e.createElement("div",{className:"message-icon"},e.createElement("div",{className:"msg-loading s-loader"}))))}}),b.exports=d},{"../../../../mixins/TimeoutMixin.js":39,"../../../constants/previewr_core_constants.js":35,"react/addons":"react/addons"}],15:[function(a,b,c){"use strict";var d,e=a("react/addons");d=e.createClass({displayName:"PageCSS",mixins:[e.addons.PureRenderMixin],propTypes:{pageObj:e.PropTypes.object},render:function(){var a=this,b=a.props.pageObj;return b&&b.css?e.createElement("style",{dangerouslySetInnerHTML:{__html:b.css}}):null}}),b.exports=d},{"react/addons":"react/addons"}],16:[function(a,b,c){"use strict";var d=a("../../../constants/previewr_core_constants.js").mail,e=d.pageStatus,f={};f[e.PAGE_READY]=a("./page_html.jsx"),f[e.PAGE_CONVERTING]=a("./page_converting.jsx"),f[e.PAGE_INVALID]=a("./page_converting.jsx"),f[e.PAGE_CONV_FAILED]=a("./page_conv_failed.jsx"),f[e.PAGE_DEFAULT]=a("./page_conv_failed.jsx"),b.exports=f},{"../../../constants/previewr_core_constants.js":35,"./page_conv_failed.jsx":13,"./page_converting.jsx":14,"./page_html.jsx":17}],17:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=e.addons.PureRenderMixin,g=a("StatService");d=e.createClass({displayName:"PageHTML",mixins:[f],propTypes:{scale:e.PropTypes.number.isRequired,width:e.PropTypes.number.isRequired,height:e.PropTypes.number.isRequired,filetype:e.PropTypes.string,pageObj:e.PropTypes.object.isRequired,pageNo:e.PropTypes.number.isRequired},getTransformStyle:function(a){var b=this,c={};return c[b.props.transformProp]="scale("+a+")",c},statSuccess:function(){var a=this,b=a.props.filetype,c=a.props.mimetype,d=a.props.pageObj;d.isSStatRecorded||(g.stat({name:"previewr_user_perceived_success",tags:{failure_type:"page",filetype:b,mimetype:c}}),d.isSStatRecorded=!0)},componentDidMount:function(){this.statSuccess()},render:function(){var a,b=this,c=b.getTransformStyle(b.props.scale),d=b.props.pageObj,f=d.html,g="pf"+b.props.pageNo;return a={width:this.props.width,height:this.props.height},e.createElement("div",{className:"page-outer-wrapper",style:a,id:g},e.createElement("div",{className:"page-inner-wrapper",style:c,dangerouslySetInnerHTML:{__html:f}}))}}),b.exports=d},{StatService:"StatService","react/addons":"react/addons"}],18:[function(a,b,c){"use strict";var d=a("../constants/previewr_core_constants.js").mail,e=d.views,f={};f[e.VIEWER_UNSUPPORTED]=a("./unsupported_viewer.jsx"),f[e.VIEWER_IMAGE]=a("./image_viewer.jsx"),f[e.VIEWER_DOC]=a("./docViewer/doc_viewer.jsx"),f[e.VIEWER_ZIP]=a("./zipViewer/zip_viewer.jsx"),b.exports=f},{"../constants/previewr_core_constants.js":35,"./docViewer/doc_viewer.jsx":10,"./image_viewer.jsx":20,"./unsupported_viewer.jsx":23,"./zipViewer/zip_viewer.jsx":34}],19:[function(a,b,c){"use strict";var d=a("../constants/previewr_core_constants.js").mail,e=d.views,f={};f[e.VIEWER_UNSUPPORTED]=a("./unsupported_viewer.jsx"),f[e.VIEWER_IMAGE]=a("./image_viewer.jsx"),f[e.VIEWER_DOC]=a("./docViewer/doc_viewer.jsx"),b.exports=f},{"../constants/previewr_core_constants.js":35,"./docViewer/doc_viewer.jsx":10,"./image_viewer.jsx":20,"./unsupported_viewer.jsx":23}],20:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js"),g=a("../../mixins/TimeoutMixin.js");d=e.createClass({displayName:"ImageViewer",propTypes:{docUrl:e.PropTypes.string.isRequired,expandMode:e.PropTypes.string},mixins:[g],getInitialState:function(){var a=this;return{imgHeight:null,imgWidth:null,zoomFactor:null,expandMode:a.props.expandMode,fetchState:null}},getImageDim:function(a){var b,c,d,e=this,f=e.state;f.fetchState||(b=new Image,c=function(){e.isMounted()&&(e.props.callbacksObj.zoomCbk=e.zoomCbk,e.props.callbacksObj.refreshZoomControls(),e.setState({imgWidth:b.width,imgHeight:b.height,fetchState:"success"}))},d=function(){e.setState({fetchState:"failure"})},f.fetchState="fetching",b.onload=c,b.onerror=d,b.src=a)},zoomCbk:function(a){var b,c=this,d=c.state,e=d.zoomFactor||1;e&&(b=e+a,5>=b&&b>=.1&&c.setState({zoomFactor:b}))},handleKeyDown:function(a){var b=this;if(a.ctrlKey)switch(a.keyCode){case 107:case 187:b.zoomCbk(.1),a.preventDefault();break;case 109:case 189:b.zoomCbk(-.1),a.preventDefault()}else;},componentDidUpdate:function(){var a=this,b=a.getDOMNode(),c=b.parentNode,d=a.state;d.expandMode!==a.props.expandMode&&(a.clearCoverSize(),a.setState({zoomFactor:null,expandMode:a.props.expandMode})),c.scrollLeft=.5*(c.scrollWidth-c.clientWidth),c.scrollTop=.5*(c.scrollHeight-c.clientHeight),a.addSetTimeout(setTimeout(function(){b=b.getElementsByClassName("image-zoom-wrapper")[0],b&&b.focus()},100))},componentWillUnmount:function(){var a=this;a.clearCoverSize()},clearCoverSize:function(){var a=this;a.coverSize.height=null,a.coverSize.width=null},coverSize:{},getWrapperSize:function(){var a,b,c,d=this,e=d.state,f=d.getDOMNode(),g=e.zoomFactor,h=e.imgHeight,i=e.imgWidth,j=d.coverSize,k={width:"100%",height:"100%",marginTop:0,marginLeft:0};return f&&(a=f.clientHeight,b=f.clientWidth,g?(j.width||(c=f.getElementsByClassName("image-zoom-wrapper")[0],j.width=c.clientWidth,j.height=c.clientHeight),k.width=j.width*g,k.height=j.height*g):b>i&&a>h&&(k.width=i,k.height=h),"100%"!==k.width&&(k.marginTop=.5*(a-k.height),k.marginLeft=.5*(b-k.width),k.marginTop<0&&(k.marginTop=0),k.marginLeft<0&&(k.marginLeft=0))),k},render:function(){var a,b,c=this,d="msg-loading s-loader",g="viewer-message",h=f.str_doc_loading,i=c.state;return"success"===i.fetchState?(b=c.getWrapperSize(),a=e.createElement("div",{className:"dummy-image-wrapper"},e.createElement("div",{className:"image-zoom-wrapper",style:{width:b.width,height:b.height,marginTop:b.marginTop,marginLeft:b.marginLeft},tabIndex:"0",onKeyDown:c.handleKeyDown},e.createElement("div",{className:"image-viewer",style:{backgroundImage:"url("+c.props.docUrl+")"}})))):("failure"===i.fetchState?(d="icon-alert icon no-padding",h=f.str_doc_failed):(g+=" delay-visiblity",c.getImageDim(this.props.docUrl)),a=e.createElement("div",{className:"image-viewer"},e.createElement("div",{className:g},e.createElement("div",{className:"message-icon"},e.createElement("div",{className:d})),e.createElement("div",{className:"message"},h)))),a}}),b.exports=d},{"../../../../artifacts/lang.js":2,"../../mixins/TimeoutMixin.js":39,"react/addons":"react/addons"}],21:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../artifacts/lang.js"),g=a("../../../utils/keyboard");d=e.createClass({displayName:"PageNavigator",propTypes:{cbkObj:e.PropTypes.object.isRequired,totalPages:e.PropTypes.number.isRequired},keyboardUtils:new g,getInitialState:function(){return{currentPageNum:this.props.currentPage,inputFocus:!1}},componentDidMount:function(){var a=this,b=this.props.cbkObj,c=a.keyboardUtils;c.addAction({keyCode:c.constants.UP},a._gotoPreviousPage),c.addAction({keyCode:c.constants.DOWN},a._gotoNextPage),c.addAction({keyCode:c.constants.ENTER},a._pageInputJumpPage),c.addAction({keyCode:c.constants.ESC},a._toggleInput),window.yui.on("themes:change",function(){a.setState()}),b.listener=function(b){a.isMounted()&&a.setState({currentPageNum:b})},b.onKeyUp=function(a){c.triggerAction(a,{e:a})}},_gotoNextPage:function(a){var b=this,c=b.state.currentPageNum,d=c+1;d<=b.props.totalPages&&b.props.cbkObj.jumpToPage(d),a.e.stopPropagation()},_gotoPreviousPage:function(a){var b=this,c=b.state.currentPageNum,d=c-1;d>=1&&b.props.cbkObj.jumpToPage(d),a.e.stopPropagation()},_pageInputJumpPage:function(a){var b=this,c=a.e.target.value,d=parseInt(c,10);d>0&&d<=b.props.totalPages&&b.props.cbkObj.jumpToPage(d),b._toggleInput()},_changePage:function(a){var b=this,c=b.keyboardUtils;c.triggerAction(a,{e:a})},_toggleInput:function(){var a=this,b=a.state.inputFocus;a.setState({inputFocus:!b},function(){var c;0===window.yui.UA.gecko&&(b||(c=a.refs.pageInput.getDOMNode(),c.selectionStart=c.value.length,c.focus()))})},render:function(){var a,b,c=this,d=c.props,g=d.totalPages,h=c.state.currentPageNum;return b=NeoConfig.isRTL?"rtl":"ltr",a=c.state.inputFocus?e.createElement("input",{className:"page-nav-input",type:"text",defaultValue:h,onKeyUp:c._changePage,onBlur:c._toggleInput,ref:"pageInput"}):e.createElement("span",{"data-stat-key":"pageNav",className:"page-nav-disp",style:{color:NeoConfig.theme.txt_g},onClick:c._toggleInput},h),e.createElement("span",{title:f.str_hover_pagenavigator,className:"page-navigator f-left",dir:b,style:{color:NeoConfig.theme.txt_g}},a,"/ ",g)}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"../../../utils/keyboard":40,"react/addons":"react/addons"}],22:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../zipViewer/zip_breadcrumb.jsx"),g=a("../zipViewer/zip_file_list.jsx"),h=a("../../../mixins/TimeoutMixin");d=e.createClass({displayName:"ZipNavigator",mixins:[h],getInitialState:function(){var a=this;return a.props.updateListener=function(){a.setState({},function(){var b=a.refs.zipDropDown.getDOMNode();b&&(b.scrollTop=0)})},a.props.toggleZipNavigator=function(b){a.setState({ddopen:b},function(){b?a.addSetTimeout(setTimeout(function(){var b=a.refs.zipDropDown.getDOMNode();b&&b.childNodes[0]&&b.childNodes[0].focus()},500)):a.addSetTimeout(setTimeout(function(){a.props.parentNode.focus()},500))})},{ddopen:void 0!==this.props.ddopen?this.props.ddopen:!0}},toggleDropdown:function(){var a=this,b=a.state.ddopen;a.setState({ddopen:!b},function(){a.props.parentNode.focus()})},render:function(){var a,b=this,c="zip-navigator-container",d="zip-navigator-ddicon icon ",h=b.props.getfolderLevel(),i={color:"#7BAEF5"},j="zip-navigator-title-container";return"#FFFFFF"===NeoConfig.theme.txt_g&&(i={color:"#FFFFFF"}),d+=b.state.ddopen?"icon-chevron-up":"icon-chevron-down",b.state.ddopen||(c+=" dd-close"),b.props.currentState&&b.props.currentState.folderLevel?0===b.props.currentState.folderLevel.length?(a=e.createElement("span",{style:i},e.createElement("span",{className:"icon icon-compressed zip-navigator-title-icon"}),e.createElement("span",null," / ")),j+=" zip-expanded"):(a=e.createElement("span",{style:i},e.createElement("span",{className:"icon icon-compressed zip-navigator-title-icon"}),e.createElement("span",null," / ... / ")),j+=" zip-expanded"):a=e.createElement("span",{style:i},b.props.fileName),e.createElement("span",{className:"zip-navigator f-left"},e.createElement("span",{onClick:b.toggleDropdown,className:j},e.createElement("span",{className:"zip-navigator-title"},a,this.props.currentState&&this.props.currentState.filename),e.createElement("span",{className:d})),e.createElement("span",{className:c},e.createElement("div",{className:"list-header disable"},e.createElement("span",{style:{marginRight:0},className:"folder-nav f-left zip-blue icon icon-compressed",onClick:b.props.closeFolder.bind(this,h.length)}),e.createElement("span",{className:"f-left zip-blue"}," / "),e.createElement("div",{className:"rest-folder f-left"},e.createElement(f,{folderLevel:h,folderMap:b.props.folderMap,closeFolder:b.props.closeFolder,helperNode:b.props.helperNode}))),e.createElement("ul",{className:"zip-navigator-dd",ref:"zipDropDown"},e.createElement(g,{folderLevel:h,folderMap:b.props.folderMap,openFolder:b.props.openFolder,closeFolder:b.props.closeFolder,getDocIcon:b.props.getDocIcon,triggerFilePreview:b.props.triggerFilePreview,toggleZipNavigator:b.props.toggleZipNavigator,partId:b.props.partId}))))}}),b.exports=d},{"../../../mixins/TimeoutMixin":39,"../zipViewer/zip_breadcrumb.jsx":28,"../zipViewer/zip_file_list.jsx":31,"react/addons":"react/addons"}],23:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js"),g=a("StatService");d=e.createClass({displayName:"UnsupportedViewer",componentDidMount:function(){var a=this,b=a.props.filetype,c=a.props.mimetype;g.stat({name:"previewr_unsupported_type",tags:{filetype:b,mimetype:c}})},onDownloadClick:function(a){this.props.callbacksObj.downloadAtt(a),g.stat({name:"previewr_tb_click",tags:{statKey:"download",downloadType:"unsupported"}})},render:function(){return e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-alert icon"})),e.createElement("div",{className:"message"},f.str_unsupported_filetype),e.createElement("div",{className:"message"},e.createElement("span",{className:"download-att",onClick:this.onDownloadClick},"Download")))}}),b.exports=d},{"../../../../artifacts/lang.js":2,StatService:"StatService","react/addons":"react/addons"}],24:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../../artifacts/lang.js");d=e.createClass({displayName:"ZipClickToView",render:function(){return e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message"},f.str_zip_click_to_preview_part1),e.createElement("div",{className:"message"},f.str_zip_click_to_preview_part2))}}),b.exports=d},{"../../../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],25:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../../artifacts/lang.js");d=e.createClass({displayName:"ZipNotPreviewable",render:function(){return e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-alert icon"})),e.createElement("div",{className:"message"},f.str_unsupported_filetype),e.createElement("div",{className:"message"},e.createElement("span",{className:"download-att",onClick:this.props.callbacksObj.downloadAtt},f.str_download_zip)))}}),b.exports=d},{"../../../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],26:[function(a,b,c){"use strict";var d=a("../../../constants/previewr_core_constants.js").mail,e=d.zipPreviewStatus,f={};f[e.CHOOSE_FILE]=a("./zip_click_to_view.jsx"),f[e.PREVIEWING]=a("./zip_previewing.jsx"),f[e.NOT_PREVIEWABLE]=a("./zip_not_viewable.jsx"),b.exports=f},{"../../../constants/previewr_core_constants.js":35,"./zip_click_to_view.jsx":24,"./zip_not_viewable.jsx":25,"./zip_previewing.jsx":27}],27:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("lodash"),g=a("../../../constants/previewr_core_constants.js").mail,h=a("../../file_previewr_zip_factory.js");d=e.createClass({displayName:"ZipPreviewing",getInitialState:function(){return{docId:this.props.docId}},getViewType:function(a){var b;return b=g.viewsmap[a]?g.viewsmap[a]:g.views.VIEWER_UNSUPPORTED,g.zipViewSupport[b]?b:g.views.VIEWER_UNSUPPORTED},render:function(){var a=this,b=a.getViewType(a.props.extension),c=f.clone(a.props),d=this.props.partId+a.state.docId;return c.docId=d,e.createElement(h[b],c)}}),b.exports=d},{"../../../constants/previewr_core_constants.js":35,"../../file_previewr_zip_factory.js":19,lodash:"lodash","react/addons":"react/addons"}],28:[function(a,b,c){"use strict";var d,e=a("react/addons");d=e.createClass({displayName:"ZipBreadCrumb",getInitialState:function(){return null},isFolderLevelExceeding:function(){var a,b,c,d,e,f,g=this,h=g.props.helperNode,i=g.props.folderLevel,j=g.props.folderMap,k='<div style="float: left;"><span class="folder-nav"><span class="icon icon-compressed" style="margin-right: 0"></span>&nbsp;/&nbsp;</span>',l=30,m=0;if(h){for(h=h.getDOMNode(),m=0;m<i.length;m++)b=m!==i.length-1?"&nbsp;/&nbsp;":"",j=j[i[m]],k=k+'<span class="folder-nav">'+i[m]+b+"</span>";if(h.innerHTML=k+"</div>",a=h.clientWidth-l,d=h.childNodes[0],c=d.offsetWidth,c>a){for(e=0,f=d.childNodes[0].offsetWidth,a-=f,m=0;m<i.length;m++)if(e+=d.childNodes[i.length-m].offsetWidth,e>=a-20&&0!==m)return i.length-(m+1);return!1}return!1}},render:function(){var a,b,c,d=this,f=[],g=d.props.folderLevel,h=d.props.folderMap;for(c=d.isFolderLevelExceeding(),c||0===c?f.push(e.createElement("span",{className:"zip-blue"},e.createElement("span",{className:"folder-nav zip-blue",onClick:d.props.closeFolder.bind(this,c)},"...")," / ")):c=-1,a=0;a<g.length;a++)h=h[g[a]],b=g.length-(a+1),a>c&&(b>0?(f.push(e.createElement("span",{className:"folder-nav zip-blue",onClick:d.props.closeFolder.bind(this,b)},g[a])),f.push(e.createElement("span",{className:"zip-blue"}," / "))):f.push(e.createElement("span",null,g[a])));return e.createElement("span",null,f)}}),b.exports=d},{"react/addons":"react/addons"}],29:[function(a,b,c){"use strict";var d,e=a("react/addons");d=e.createClass({displayName:"ZipFailed",render:function(){return e.createElement("div",{className:"viewer-message"},e.createElement("div",{className:"message-icon"},e.createElement("i",{className:"icon-spam icon"})),e.createElement("div",{className:"message"},"ZIP Processing Failed ... Try Again"))}}),b.exports=d},{"react/addons":"react/addons"}],30:[function(a,b,c){"use strict";var d=a("../../constants/previewr_core_constants.js").mail,e=d.docStatus,f={};f[e.ZIPPED_FILE]=a("./zip_ready.jsx"),f[e.DOC_NOT_READY_FOR_VIEW]=a("./zip_not_ready.jsx"),f[e.DOC_CONVERSION_FAILED]=a("./zip_conversion_failed.jsx"),b.exports=f},{"../../constants/previewr_core_constants.js":35,"./zip_conversion_failed.jsx":29,"./zip_not_ready.jsx":32,"./zip_ready.jsx":33}],31:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../mixins/TimeoutMixin"),g=a("../../../utils/keyboard");d=e.createClass({displayName:"ZipFileList",mixins:[f],keyboardUtil:new g,getInitialState:function(){return{currentNavPos:null}},componentDidUpdate:function(){this._focusList()},componentDidMount:function(){var a=this,b=a.keyboardUtil;b.addAction({keyCode:b.constants.UP
},a._moveUp),b.addAction({keyCode:b.constants.DOWN},a._moveDown),b.addAction({keyCode:b.constants.LEFT},a._closeFolder),b.addAction({keyCode:b.constants.RIGHT},a._openFolder),b.addAction({keyCode:b.constants.ENTER},a._openFile),b.addAction({keyCode:b.constants.ESC},a._closeZipNavigator),a._focusList()},_focusList:function(){var a=this;a.addSetTimeout(setTimeout(function(){a.getDOMNode().focus()},200))},_scrollActiveListItemIntoView:function(a){var b,c=this;c.addSetTimeout(setTimeout(function(){b=c.refs.activeKeyItem.getDOMNode(),b&&b.scrollIntoView(a)},200))},_moveUp:function(){var a,b=this,c=b.state.currentNavPos;a=c-1,0>a&&(a=0),b.setState({currentNavPos:a},function(){b._scrollActiveListItemIntoView(!0)})},_moveDown:function(a){var b,c=this,d=c.state.currentNavPos;b=d+1,b>=a.maxLimit&&(b=a.maxLimit-1),c.setState({currentNavPos:b},function(){c._scrollActiveListItemIntoView(!1)})},_openFolder:function(a){var b=this;"object"!=typeof a.actionData&&(b.props.openFolder(a.actionData),b.setState({currentNavPos:0}))},_closeFolder:function(){var a=this;a.props.closeFolder(),a.setState({currentNavPos:0})},_openFile:function(a){var b=this;"object"==typeof a.actionData&&b.props.triggerFilePreview(a.actionData)},_closeZipNavigator:function(){var a=this;a.props.toggleZipNavigator(!1)},_keyPressHandler:function(a,b,c){var d=this,e=d.keyboardUtil,f=d.state.currentNavPos;return null!==f||c.keyCode!==e.constants.UP&&c.keyCode!==e.constants.DOWN?void e.triggerAction(c,{actionData:a,e:c,maxLimit:b},function(){c.preventDefault(),c.stopPropagation()}):(c.preventDefault(),c.stopPropagation(),void d.setState({currentNavPos:0}))},render:function(){var a,b,c,d=this,f=[],g=d.props.folderLevel,h=d.props.folderMap,i=null,j=0;for(a=0;a<g.length;a++)h=h[g[a]];for(a in h)h.hasOwnProperty(a)&&("object"==typeof h[a]?(c="files-item",j===d.state.currentNavPos?(c+=" key-hover",i=a,f.push(e.createElement("li",{className:c,key:j,ref:"activeKeyItem",onClick:d.props.openFolder.bind(null,a)},e.createElement("div",{className:"icon-folder icon f-left"}),e.createElement("div",{className:"foldername f-left"},a),e.createElement("div",{className:"icon-chevron-right icon f-right"})))):f.push(e.createElement("li",{className:c,key:j,onClick:d.props.openFolder.bind(null,a)},e.createElement("div",{className:"icon-folder icon f-left"}),e.createElement("div",{className:"foldername f-left"},a),e.createElement("div",{className:"icon-chevron-right icon f-right"})))):(c="files-item file",b="f-left icon file-icon "+d.props.getDocIcon(a),d.props.partId===h[a]&&(c+=" active"),j===d.state.currentNavPos?(c+=" key-hover",i={partId:h[a],filename:a},f.push(e.createElement("li",{className:c,key:j,ref:"activeKeyItem",onClick:d.props.triggerFilePreview.bind(this,{partId:h[a],filename:a})},e.createElement("div",{className:b}),e.createElement("div",{className:"f-left filename"},a)))):f.push(e.createElement("li",{className:c,key:j,onClick:d.props.triggerFilePreview.bind(this,{partId:h[a],filename:a})},e.createElement("div",{className:b}),e.createElement("div",{className:"f-left filename"},a)))),j++);return e.createElement("span",{onKeyDown:d._keyPressHandler.bind(this,i,j),className:"zip-dd-focus optionMenu",tabIndex:"1"},f)}}),b.exports=d},{"../../../mixins/TimeoutMixin":39,"../../../utils/keyboard":40,"react/addons":"react/addons"}],32:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../../artifacts/lang.js");d=e.createClass({displayName:"ZipLoading",getInitialState:function(){var a=this;return a.props.callbacksObj.fetchAction({docId:a.props.docId,reqPageNumber:1}),null},render:function(){return e.createElement("div",{className:"viewer-message delay-visiblity"},e.createElement("div",{className:"message-icon"},e.createElement("div",{className:"msg-loading s-loader"})),e.createElement("div",{className:"message"},f.str_zip_loading))}}),b.exports=d},{"../../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],33:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("lodash"),g=a("context-mixin"),h=a("../../../mixins/TimeoutMixin"),i=a("../../constants/previewr_core_constants.js").mail,j=a("../../actions/previewr_core_actions.js"),k=a("./zipPreview/zip_preview_factory.js"),l=a("../toolbarComponents/zip_navigator.jsx"),m=a("./zip_breadcrumb.jsx"),n=a("./zip_file_list.jsx"),o=a("../../../utils/keyboard");d=e.createClass({displayName:"ZipReady",mixins:[g,h],keyboardUtils:new o,getInitialState:function(){var a,b=this;return a=b.generateFolderStructure(b.props.docData.info.file_map),b.folderMap=a.folderMap,b.partsInfo=a.partsInfo,b.currentState={},{folderLevel:[],partId:void 0,currentKey:-1,key:"initial"}},componentDidMount:function(){var a=this,b=a.keyboardUtils;b.addAction({keyCode:b.constants.DOWN,altKey:!0},a._openZipNavigator),a.props.callbacksObj.setZipNavigator(!0,function(){a.addZipNavigator()}),a.addSetTimeout(setTimeout(function(){a.context.executeAction(j.incrementDocCount,a.props.docId)},0)),a.addSetTimeout(setTimeout(function(){a.getDOMNode().focus()},200))},componentWillUnmount:function(){var a=this;a.context.executeAction(j.decrementDocCount,a.props.docId)},getFolderLevel:function(){return this.state.folderLevel},addZipNavigator:function(a){var b=this;b.zipNavigator=e.createElement(l,{ddopen:a,toggleZipNavigator:null,updateListener:null,currentState:b.currentState,getfolderLevel:b.getFolderLevel,folderMap:b.folderMap,openFolder:b.openFolder,closeFolder:b.closeFolder,getDocIcon:b.getDocIcon,triggerFilePreview:b.triggerFilePreview,fileName:b.props.fileName,partId:b.state.partId,helperNode:b.refs.ziphelper,parentNode:b.getDOMNode()}),b.props.callbacksObj.addToolbarItem(b.zipNavigator,{pos:3,expandMode:"collapsed"})},generateFolderStructure:function(a){var b,c,d,e,g,h={},i={},j=[],k={};for(b in a)a.hasOwnProperty(b)&&(j.push(a[b][1]),k[a[b][1]]=b);return j=f.sortBy(j),j=j.reverse(),f.forEach(j,function(j){for(b=k[j],c=a[b][1].split("/"),i[b]={isPreviewable:parseInt(a[b][0]),navSteps:[],filename:c[c.length-1]},e={},g=e,d=0;d<c.length;d++)d!==c.length-1?(i[b].navSteps.push(c[d]),g[c[d]]={}):g[c[d]]=b,g=g[c[d]];f.merge(h,e)}),{folderMap:h,partsInfo:i}},openFolder:function(a){var b=this,c=b.state.folderLevel;c.push(a),b.setState({folderLevel:c},function(){b.props.zipMode&&b.zipNavigator&&b.zipNavigator.props.updateListener&&b.zipNavigator.props.updateListener()})},closeFolder:function(a){var b,c=this,d=c.state.folderLevel;if(a)for(b=0;a>b;b++)d.pop();else d.pop();this.setState({folderLevel:d},function(){c.props.zipMode&&c.zipNavigator&&c.zipNavigator.props.updateListener&&c.zipNavigator.props.updateListener()})},getFileExtension:function(a){return a&&a.split(".").pop()},getDocIcon:function(a){var b=this.getFileExtension(a),c=i.fileIcons[b];return c?c:"icon-attachment-big"},triggerFilePreview:function(a){var b=this;b.state.partId!==a.partId&&(b.filePreviewrProps=f.clone(b.props.filePreviewrProps),b.props.callbacksObj.resetTbItems(function(){b.props.callbacksObj.addDefaultTBItems(),b.currentState.filename=a.filename,b.currentState.partId=a.partId,b.currentState.folderLevel=f.map(b.getFolderLevel(),f.clone),b.setState({partId:a.partId,key:a.partId},function(){b.addZipNavigator(!1)})}))},toggleZipNavigator:function(a){var b=this;b.zipNavigator&&b.zipNavigator.props&&b.zipNavigator.props.toggleZipNavigator&&b.zipNavigator.props.toggleZipNavigator(a)},_openZipNavigator:function(a){this.toggleZipNavigator(!0),a.e.stopPropagation(),a.e.preventDefault()},_handleKeys:function(a){var b=this,c=b.keyboardUtils;c.triggerAction(a,{e:a})},render:function(){var a,b,c,d,g=this,h=g.state.folderLevel;return c="zip-file-preview",d="zip-file-list",("collapsed"===this.props.expandMode||"presentation"===this.props.expandMode)&&(c+=" file-list-off",d+=" file-list-off"),b=g.state.partId?g.partsInfo[g.state.partId].isPreviewable?i.zipPreviewStatus.PREVIEWING:i.zipPreviewStatus.NOT_PREVIEWABLE:i.zipPreviewStatus.CHOOSE_FILE,a=k[b],e.createElement("div",{onKeyDown:g._handleKeys,tabIndex:"1"},e.createElement("div",{className:d},e.createElement("div",{className:"list-header"},e.createElement("span",{className:"folder-nav f-left zip-blue",onClick:g.closeFolder.bind(this,h.length)},e.createElement("span",{className:"icon icon-compressed",style:{marginRight:0}})),e.createElement("span",{className:"f-left zip-blue"}," / "),e.createElement("div",{className:"rest-folder f-left"},e.createElement(m,{folderLevel:g.state.folderLevel,folderMap:g.folderMap,closeFolder:g.closeFolder,helperNode:g.refs.ziphelper}))),e.createElement("div",{className:"file-list-disp"},e.createElement("ul",null,e.createElement(n,{folderLevel:g.state.folderLevel,folderMap:g.folderMap,openFolder:g.openFolder,closeFolder:g.closeFolder,toggleZipNavigator:g.toggleZipNavigator,getDocIcon:g.getDocIcon,triggerFilePreview:g.triggerFilePreview,partId:g.state.partId})))),e.createElement("div",{className:c,key:g.state.key,onClick:function(){g.toggleZipNavigator(!1)}},e.createElement(a,f.merge(g.props,{partId:g.state.partId,extension:g.getFileExtension(g.currentState.filename)}))),e.createElement("div",{ref:"ziphelper",className:"zip-viewer-helper"}))}}),b.exports=d},{"../../../mixins/TimeoutMixin":39,"../../../utils/keyboard":40,"../../actions/previewr_core_actions.js":3,"../../constants/previewr_core_constants.js":35,"../toolbarComponents/zip_navigator.jsx":22,"./zipPreview/zip_preview_factory.js":26,"./zip_breadcrumb.jsx":28,"./zip_file_list.jsx":31,"context-mixin":"context-mixin",lodash:"lodash","react/addons":"react/addons"}],34:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../stores/previewr_core_document_store.js"),g=a("../../constants/previewr_core_constants.js").mail,h=a("../../../mixins/StoreMixin.js"),i=a("context-mixin"),j=a("./zip_factory.js");d=e.createClass({displayName:"ZipViewer",mixins:[i,h],getStores:function(){return{PreviewrDocStore:this.context.getStore(f)}},render:function(){var a=this,b=a.props.docId,c=a.stores.PreviewrDocStore.getDocStatus(b)||g.docStatus.DOC_NOT_READY_FOR_VIEW,d=a.stores.PreviewrDocStore.getDocData(b);return a.props.docData=d,a.props.docStatus=c,e.createElement("div",{className:"zip-viewer"},e.createElement(j[c],a.props))}}),b.exports=d},{"../../../mixins/StoreMixin.js":38,"../../constants/previewr_core_constants.js":35,"../../stores/previewr_core_document_store.js":36,"./zip_factory.js":30,"context-mixin":"context-mixin","react/addons":"react/addons"}],35:[function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=a("lodash");d=["PREVIEWR_CORE_RESET_PASSWORD_VIEW","PREVIEWR_CORE_SET_PAGE_DATA","PREVIEWR_CORE_SET_SCROLL_PERCENT","PREVIEWR_CORE_OPEN_DOCUMENT","PREVIEWR_CORE_CLOSE_DOCUMENT","PREVIEWR_CORE_DELETE_DOC","PREVIEWR_CORE_DELETE_PAGE"],e=["PREVIEWR_CORE_EVENTS_PAGE_FETCHED"],i=["CHOOSE_FILE","NOT_PREVIEWABLE","PREVIEWING"],f=["DOC_READY_FOR_VIEW","DOC_CONVERSION_FAILED","DOC_NOT_READY_FOR_VIEW","DOC_EXCEL_TABS","DOC_PASSWORD_VIEWABLE","DOC_PASSWORD_NOT_VIEWABLE","DOC_PASSWORD_WRONG","ZIPPED_FILE"],g={PAGE_READY:700,PAGE_CONVERTING:701,PAGE_INVALID:702,PAGE_CONV_FAILED:704,NETWORK_FAILURE:704,PAGE_DEFAULT:"DEFAULT_PAGE"},p={MAX_PAGE_RETRIES:5,RETRY_DELAY:2500},k=["VIEWER_DOC","VIEWER_IMAGE","VIEWER_ZIP","VIEWER_UNSUPPORTED"],j={},j[k[0]]=!0,j[k[1]]=!1,j[k[2]]=!1,j[k[3]]=!0,n=["zip"],m=["image","jpg","png","gif","tiff","jpeg","bmp"],l=["pdf","ppt","pptx","xls","xlsx","doc","docx"],o=["PRESENTATION","INFINITE_SCROLL"],q={INTERNAL_SERVER_ERROR:"Some Internal Server Error",NETWORK_FAILURE:"Network Down"},h={doc:"icon-doc",docx:"icon-doc",xls:"icon-spreadsheet",xlsx:"icon-spreadsheet",ppt:"icon-ppt",pptx:"icon-ppt",image:"icon-file",zip:"icon-compressed",pdf:"icon-pdf"},r=s.zipObject(l,s.map(l,function(){return k[0]})),r=s.merge(s.zipObject(m,s.map(m,function(){return k[1]})),r),r=s.merge(s.zipObject(n,s.map(n,function(){return k[2]})),r),b.exports={mail:{actions:s.zipObject(d,d),events:s.zipObject(e,e),docStatus:s.zipObject(f,f),pageStatus:g,zipPreviewStatus:s.zipObject(i,i),fileIcons:h,thresholdObj:p,errorMessages:q,views:s.zipObject(k,k),zoomType:s.zipObject(o,o),viewsmap:r,zipViewSupport:j}}},{lodash:"lodash"}],36:[function(a,b,c){"use strict";var d,e=a("lodash"),f=a("../constants/previewr_core_constants.js").mail,g=a("dispatchr/utils/BaseStore");d=function(){this._docStore={},this._storeSize=0,this._storeMaxSize=10},d.prototype=e.create(g.prototype,{getDocStatus:function(a){return this._docStore[a]?this._docStore[a].docStatus:null},getDocData:function(a){return this._docStore[a]},getDocPageCount:function(a){return this._docStore[a].info.num_pages},getValidStatusCode:function(a){var b=a.statuscode,c=a.retries;return c>=f.thresholdObj.MAX_PAGE_RETRIES&&b!==f.pageStatus.PAGE_READY?f.pageStatus.PAGE_CONV_FAILED:b},htmlDecode:function(a){return a?a.replace(/&(#?[\w\d]+);?/g,function(a,b){var c,d;return"#"===b.charAt(0)&&(d="x"===b.charAt(1)?parseInt(b.substr(2).toLowerCase(),16):parseInt(b.substr(1)),isNaN(d)||-32768>d||d>65535||(c=String.fromCharCode(d))),c||a}):void 0},setPageData:function(a){var b,c,d,g,h,i=this,j=a.docId,k=i._docStore,l=a.errorCode,m=i.getDocStatus(j);if(a=a.resultObj,a.success){if(m!==f.docStatus.DOC_READY_FOR_VIEW?(b=null,603===a.statuscode?m=f.docStatus.DOC_PASSWORD_VIEWABLE:630===a.statuscode?m=f.docStatus.DOC_PASSWORD_WRONG:625===a.statuscode?(m=f.docStatus.ZIPPED_FILE,b=a.info):a&&a.info?(b=a.info,m=f.docStatus.DOC_READY_FOR_VIEW):(m=f.docStatus.DOC_CONVERSION_FAILED,h=l+"_"+a.statuscode),k[j]={docStatus:m,pages:{},fontStore:{},info:b,handler:a&&a.handler,pointer_count:1},h&&(k[j].docError=h)):a&&a.info&&a.info.num_pages>0&&(k[j].info=a.info,603!==a.statuscode?k[j].docStatus=f.docStatus.DOC_READY_FOR_VIEW:k[j].docStatus=f.docStatus.DOC_PASSWORD_VIEWABLE),a&&a.pages){for(c in a.pages)a.pages.hasOwnProperty(c)&&(d=a.pages[c],d.html=i.htmlDecode(d.html),g=k[j].pages[c],d.retries=g?++g.retries:0,d.statuscode=i.getValidStatusCode(d,k[j].info));k[j].pages=e.merge(k[j].pages,a.pages)}}else if(k[j]){if(!a.start_page)return;for(c=a.start_page;c<=a.end_page;c++)k[j].pages["page"+c]||(k[j].pages["page"+c]={}),k[j].pages["page"+c].statuscode=f.pageStatus.NETWORK_FAILURE}else k[j]={docStatus:f.docStatus.DOC_CONVERSION_FAILED,docError:l};setTimeout(function(){i.emitChange()},0)},cleanDocStore:function(){var a,b=this;for(a in b._docStore)0===b._docStore[a].pointer_count&&delete b._docStore[a]},setScrollPercent:function(a){var b=this,c=b._docStore[a.docId];c&&(c.scroll_percent={percent:a.scrollPercent,page:a.currentPage})},resetPasswordView:function(a){var b=this,c=b._docStore[a];c.docStatus=f.docStatus.DOC_PASSWORD_VIEWABLE,b.emitChange()},openDocument:function(a){var b=this,c=b._docStore[a];c.pointer_count=c.pointer_count+1,b._storeSize=e.keys(b._docStore).length,b._storeSize>b._storeMaxSize&&b.cleanDocStore()},closeDocument:function(a){var b,c,d=this,g=d._docStore[a];if(!g)return null;if(b=g.info&&g.info.hpwd?!0:!1,g.pointer_count=g.pointer_count-1,b)0===g.pointer_count&&delete d._docStore[a];else{d._storeSize=e.keys(d._docStore).length,g.docStatus===f.docStatus.DOC_CONVERSION_FAILED&&delete d._docStore[a];for(c in g.pages)g.pages[c].statuscode===f.pageStatus.PAGE_CONV_FAILED&&(g.pages[c].statuscode=f.pageStatus.PAGE_CONVERTING);d._storeSize>d._storeMaxSize&&d.cleanDocStore()}},deleteDoc:function(a){delete this._docStore[a],this.emitChange()},deletePage:function(a){delete this._docStore[a.docId].pages["page"+a.pageNo],this.emitChange()}}),d.storeName="PreviewrCoreDocumentStore",d.handlers={},d.handlers[f.actions.PREVIEWR_CORE_RESET_PASSWORD_VIEW]="resetPasswordView",d.handlers[f.actions.PREVIEWR_CORE_SET_SCROLL_PERCENT]="setScrollPercent",d.handlers[f.actions.PREVIEWR_CORE_OPEN_DOCUMENT]="openDocument",d.handlers[f.actions.PREVIEWR_CORE_CLOSE_DOCUMENT]="closeDocument",d.handlers[f.actions.PREVIEWR_CORE_SET_PAGE_DATA]="setPageData",d.handlers[f.actions.PREVIEWR_CORE_DELETE_DOC]="deleteDoc",d.handlers[f.actions.PREVIEWR_CORE_DELETE_PAGE]="deletePage",b.exports=d},{"../constants/previewr_core_constants.js":35,"dispatchr/utils/BaseStore":57,lodash:"lodash"}],37:[function(a,b,c){"use strict";YUI.add("tictac-previewr",function(b){var c=b.common.Utils.features,d=c.enabled("zipPreviewr"),e=c.enabled("excelPreviewr");b.namespace("Tictac").previewr={loader:function(){},getLaunchURLStyleNode:function(){var a=document.createElement("link"),b=window.YUI_config.groups.storm_css,c=b.root,d=b.suffix+".css",e=["messagelist","ads"];return NeoConfig.FF_features.betaFonts&&e.push("beta-fonts"),a.rel="stylesheet",a.href=b.comboBase+e.map(function(a){return c+a+d}).join("&"),a},loadViewer:function(c,f,g){var h,i,j,k,l=a("./core/stores/previewr_core_document_store.js"),m=a("PreviewrWrapper"),n=a("react/addons"),o=window.ReactContext,p=o.contextInst,q=c.isFullScreenContainer?0:-37,r=c.getDOMNode(),s=document.createElement("link"),t=document.createElement("style"),u="",v=this;yui.UA.ie&&(u='src="/neo/ie_blank"'),b.fire("Feedback:close"),h=document.createElement("div"),h.setAttribute("style","position:absolute; width: 100%; top: "+q+"px; bottom: 0px;"),h.innerHTML="<iframe "+u+' style="width:100%; height:100%; border: none;"> </iframe>',t.innerHTML=a("../../artifacts/css/main.css")+"body{margin: 0;}",s.rel="stylesheet",s.href=NeoConfig.theme.url,k=yui.on("themes:change",function(a){s.href=a.css}),h.querySelector("iframe").addEventListener("load",function(){var a=h.querySelector("iframe").contentWindow;j=a.document,j.head.innerHTML="",j.body.innerHTML="",j.head.appendChild(v.getLaunchURLStyleNode()),j.head.appendChild(s),j.head.appendChild(t),o.registerStore(l),i=o.contextInst.getComponentContext().getStore(l),n.withContext(p.getComponentContext(),function(){var b=n.createElement(m,{msgObj:g,attachments:f,container:c,isZipEnabled:d,isSheetsViewEnabled:e});a.addEventListener("unload",function(){n.unmountComponentAtNode(j.body),yui.detach(k)}),n.render(b,j.body)})}),r.appendChild(h)}}},"1.0.0",{requires:["tictac-base","tictac-lib","tictac-base-mailpreferences"]})},{"../../artifacts/css/main.css":1,"./core/stores/previewr_core_document_store.js":36,PreviewrWrapper:"PreviewrWrapper","react/addons":"react/addons"}],38:[function(a,b,c){"use strict";var d,e=a("lodash"),f=a("react/addons");d={propTypes:{getStores:f.PropTypes.func},getInitialState:function(){return this._bindStores(),{timestamp:e.now()}},_bindStores:function(){var a=this.getStores();this.stores={},e.each(a,function(a,b){this.stores[b]=a},this)},componentDidMount:function(){e.each(this.stores,function(a){a.addChangeListener(this._onChange)},this)},componentWillUnmount:function(){e.each(this.stores,function(a){a.removeChangeListener(this._onChange)},this)},_onChange:function(){this.setState({timestamp:this.state.timestamp+1})}},b.exports=d},{lodash:"lodash","react/addons":"react/addons"}],39:[function(a,b,c){"use strict";var d,e=a("lodash"),f=a("react/addons");d={propTypes:{addSetTimeout:f.PropTypes.func,addSetTimeInterval:f.PropTypes.func},getInitialState:function(){return this.setTimeouts=[],this.setTimeIntervals=[],{}},componentWillUnmount:function(){e.each(this.setTimeouts,function(a){clearTimeout(a)}),e.each(this.setTimeIntervals,function(a){clearInterval(a)}),this.setTimeouts=[],this.setTimeIntervals=[]},addSetTimeout:function(a){this.setTimeouts.push(a)},addSetTimeInterval:function(a){this.setTimeIntervals.push(a)}},b.exports=d},{lodash:"lodash","react/addons":"react/addons"}],40:[function(a,b,c){"use strict";var d=a("lodash"),e={ESC:27,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,KEY_F:70};b.exports=function(){return d.extend(this,{actionsKeysMap:{},constants:e,generateActionKeyMap:function(a){return(a.ctrlKey?1:0)+"_"+(a.shiftKey?1:0)+"_"+(a.metaKey?1:0)+"_"+(a.altKey?1:0)+"_"+a.keyCode},addAction:function(a,b){var c=this,d=c.generateActionKeyMap(a);this.actionsKeysMap[d]=b},triggerAction:function(a,b,c){var d=this,e=d.generateActionKeyMap(a);"function"==typeof d.actionsKeysMap[e]&&(d.actionsKeysMap[e](b),"function"==typeof c&&c())}})}},{lodash:"lodash"}],41:[function(a,b,c){"use strict";var d=a("../../core/constants/previewr_core_constants.js").mail,e=a("StatService"),f=a("IO"),g=18e3;b.exports={retry_delay:1e3,fetchPreviewData:function(a,b){var c,d,e,f,g=b.reqPageNumber,h={},i=this,j=b.docId,k=b.partId,l=b.sheetInfo,m=i._fetchArr,n=i._xhrObj,o=3,p=6,q=b.pwd,r=b.hpwd,s=b.pageCount||1e4;k&&(h.zip_id=k),l&&(j=j.replace(l.name,""),g=l.startpage+g-1,s=l.actualPageCount),f=g%o===0,e=(Math.floor(g/o)+(f?-1:0))*o+1,h.start_page=g,h.end_page=e+o-1,h.end_page=h.end_page>s?s:h.end_page,q?h.pwd=q:r&&(h.hpwd=r),h.start_page>s||(c=i._getReqIdFromRange(e,h.end_page,j),n[c]||(m.length===p&&(d=m[0],n[d].xhr.cancel(),delete n[d],m.splice(0,1)),this._xhrFetchPreviewData(a,h,{docId:j,chunkStartNo:e})))},_fetchArr:[],_xhrObj:{},_getReqIdFromRange:function(a,b,c){return a+"_"+b+"_"+c},_terminateRetry:function(a){a&&(a.retrycount=0,a.retry=!1)},_handleRetry:function(a,b){if(b>0){if(a.retrycount&&a.retrycount>=b)return void(a.retry=!1);a.retrycount=a.retrycount?a.retrycount+1:1,a.retry=!0}else a.retry=!1},_handle400Error:function(a,b){var c,e=this,f=e._xhrObj[b];try{c=JSON.parse(a.text)}catch(g){c=null}if(c)switch(c.code){case 802:e._handleRetry(f,1);break;case 803:e._handleRetry(f,1);break;case 804:e._handleRetry(f,1);break;case 805:e._handleRetry(f,1);break;case 806:e._handleRetry(f,0);break;case 807:e._handleRetry(f,0);break;case 808:e._handleRetry(f,0);break;case 813:e._handleRetry(f,0);break;default:e._handleRetry(f,0)}return{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}},_handle401Error:function(a,b){var c=this,e=c._xhrObj[b];return this._handleRetry(e,1),{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}},_handle404Error:function(a,b){var c=this,e=c._xhrObj[b];return this._handleRetry(e,1),{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}},_handle500Error:function(a,b){var c=this,e=c._xhrObj[b];return this._handleRetry(e,2),{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}},_handleUnexpectedErrors:function(a,b){var c=this,e=c._xhrObj[b];return c._terminateRetry(e),{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}},_handleNetworkFailure:function(a,b){var c=this,e=c._xhrObj[b];return c._terminateRetry(e),{message:d.errorMessages.NETWORK_FAILURE,success:!1,start_page:e&&e.fetchoptions.start_page||1,end_page:e&&e.fetchoptions.end_page||1}},_handle200Request:function(a,b){var c,e=this,f=e._xhrObj[b];try{c=JSON.parse(a.text)}catch(g){c=null}if(c){switch(c.code){case 800:e._terminateRetry(f),c.success=!0;break;case 809:e._handleRetry(f,1);break;case 811:e._handleRetry(f,1);break;case 812:c.success=!1;break;case 814:e._handleRetry(f,10);break;case 815:e._terminateRetry(f),c.success=!0;break;case 816:e._terminateRetry(f),c.success=!0;break;default:return{message:d.errorMessages.INTERNAL_SERVER_ERROR,success:!1}}return c}},_dispatchToStore:function(a,b){var c,e=this,f=e._fetchArr,g=b.context,h=b.reqId,i=b.fetchMetaData,j=b.docId,k=b.fetchoptions,l=(new Date).getTime()-b.startTime,m=e._xhrObj;switch(a.status){case 400:c=e._handle400Error(a,h);break;case 401:c=e._handle401Error(a,h);break;case 404:c=e._handle404Error(a,h);break;case 500:c=e._handle500Error(a,h);break;case 800:return;case 200:c=e._handle200Request(a,h);break;case 0:c=e._handleNetworkFailure(a,h);break;default:c=e._handleUnexpectedErrors(a,h)}c=c||{},e.statLatency(l,a.status,c.code),m[h]&&m[h].retry?setTimeout(function(){e._xhrFetchPreviewData(g,k,i,!0)},e.retry_delay):(delete m[h],g.dispatch(d.actions.PREVIEWR_CORE_SET_PAGE_DATA,{resultObj:c,docId:j,errorCode:a.status+"_"+c.code}),f.splice(f.indexOf(h),1))},statLatency:function(a,b,c){var d="previewr_xhr_latency";a>g&&(d="previewr_xhr_high_latency"),e.stat({name:d,unit:"ms",type:"duration",dataum:a,tags:{xhrResponseCode:b,resultResponseCode:c||"default"}})},_xhrFetchPreviewData:function(a,b,c,d){var e,g=this,h=c.docId,i=g._getReqIdFromRange(c.chunkStartNo,b.end_page,h),j=g._fetchArr,k=yui.common.net.Session.genReqID(),l=g._xhrObj,m={};e=b.zip_id?{headers:{"Docs-Document-Id":h.replace(b.zip_id,"")}}:{headers:{"Docs-Document-Id":h}},d||(j.push(i),l[i]={}),m.context=a,m.reqId=i,m.docId=h,m.fetchMetaData=c,m.fetchoptions=b,m.startTime=(new Date).getTime(),e.timeout=25e3,l[i].fetchoptions=b,l[i].xhr=f.post("/ws/docpreview/v2/fetch?ymreqid="+k,b,e).then(function(a){g._dispatchToStore(a,m)},function(a){g._dispatchToStore(a,m)})}}},{"../../core/constants/previewr_core_constants.js":35,IO:"IO",StatService:"StatService"}],42:[function(a,b,c){"use strict";var d=a("./fetch_utils.js");b.exports={fetchPreviewData:function(a,b){d.fetchPreviewData(a,b)}}},{"./fetch_utils.js":41}],43:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js");d=e.createClass({displayName:"AttachmentDownloader",render:function(){var a=this;return e.createElement("i",{title:f.str_hover_download,"data-stat-key":"download",className:"icon btn icon-download f-left attachment-downloader",onClick:function(){a.props.downloadActiveAtt()}})}}),b.exports=d},{"../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],44:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js");d=e.createClass({displayName:"AttachmentNavigator",propTypes:{clickHandler:e.PropTypes.func.isRequired,isDisabled:e.PropTypes.bool.isRequired,direction:e.PropTypes.string.isRequired},render:function(){var a,b=this,c=b.props.direction,d="nav-handles "+c;return this.props.isDisabled&&(d+=" disabled"),"prev"===c?(a=f.str_hover_prev_attachment,d+=" f-left"):(a=f.str_hover_next_attachment,d+=" f-right"),NeoConfig.isRTL&&(d+=" nav-rtl-tranform"),e.createElement("div",{title:a,className:d,onClick:this.props.clickHandler})}}),b.exports=d},{"../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],45:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js"),g=a("../constants/previewr_wrapper_constants.js").sizeMap,h=a("../../mixins/TimeoutMixin.js");d=e.createClass({displayName:"HoverCard",propTypes:{msgObj:e.PropTypes.object},evtHandler:null,getBackHoverMarkup:function(){var a=this;return a.props.msgObj?e.createElement("div",null,e.createElement("div",{className:"from-header"},e.createElement("h2",null,e.createElement("span",null,f.str_from),e.createElement("span",null,a.props.msgObj.header.from.name))),e.createElement("div",{className:"mail-body",dangerouslySetInnerHTML:{__html:a.props.msgObj.body.display}})):null},getInitialState:function(){return{backgroundUrl:""}},render:function(){var a=this;return e.createElement("div",{"data-stat-key":"backHover",className:"back-hover-msg"},e.createElement("div",{className:"inner-content"},a.getBackHoverMarkup()))}}),b.exports=e.createClass({displayName:"exports",propTypes:{msgObj:e.PropTypes.object,setTbExpandMode:e.PropTypes.func,getTbExpandMode:e.PropTypes.func,cont:e.PropTypes.object},mixins:[h],render:function(){var a,b,c,g=this;return b=NeoConfig.isRTL?"icon-arrow-right f-left icon":"icon-arrow-left f-left icon",a=e.createElement("span",{"data-stat-key":"back",className:"btn back-msg-btn",onClick:function(){return g.isSmallScreen?void g.props.cont.requestClose():void g.props.setTbExpandMode("collapsed")}},e.createElement("i",{className:b}),e.createElement("span",{className:"v-top btn-label f-left"},f.str_goback_message),e.createElement(d,{msgObj:g.props.msgObj})),c=g.props.getTbExpandMode(),"collapsed"!==c?e.createElement("span",{className:"expanded-icons f-left"},a):null},isSmallScreen:!1,resizeHandler:function(a){var b=this,c=g.SPLIT_SCREEN_WIDTH_THRESHOLD,d=b.props.getTbExpandMode(),e=10,f=g.FULL_SCREEN_WIDTH_THRESHOLD;return b.isSmallScreen&&a>f&&a>e&&"presentation"!==d?(b.props.setTbExpandMode("collapsed"),void(b.isSmallScreen=!1)):!b.isSmallScreen&&c>a&&a>e&&"presentation"!==d?(b.props.setTbExpandMode("expanded"),void(b.isSmallScreen=!0)):void("expanded"===d&&f>a&&(b.isSmallScreen=!0))},componentWillUnmount:function(){var a=this.props.cont.getDOMNode(),b=this,c=a.getElementsByTagName("iframe")[0],d=c&&c.contentWindow;d&&(d.removeEventListener("resize",b.evtHandler),b.evtHandler=null)},getInitialPreviewPaneWidth:function(){var a=document.getElementById("paneshell").clientWidth,b=document.getElementById("shellnavigation").clientWidth,c=this.props.getTbExpandMode();return"expanded"===c?a-b:(a-b)/2},componentDidMount:function(){var a=this.props.cont.getDOMNode(),b=this,c=a.getElementsByTagName("iframe")[0],d=c&&c.contentWindow,e=b.getInitialPreviewPaneWidth();d&&(b.evtHandler=function(a){b.addSetTimeout(setTimeout(function(){b.resizeHandler(a.target.innerWidth)},10))},d.addEventListener("resize",b.evtHandler),b.resizeHandler(e))}})},{"../../../../artifacts/lang.js":2,"../../mixins/TimeoutMixin.js":39,"../constants/previewr_wrapper_constants.js":52,"react/addons":"react/addons"}],46:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js");d=e.createClass({displayName:"BugReporter",reportBug:function(a){var b={},c={email:yui.common.Utils.settings.value("docpreviewFeedbackEmail"),name:f.str_bug_mail_name},d=f.str_bug_report_body;return d+="<br>"+JSON.stringify(this.props.activeAtt,!0," "),b.subject=f.str_bug_subj,b.to=[c],a.setHeader(b),a.body.html=d,a.origin.oMsg={sourceFolderInfo:{fid:"Draft"}},!0},render:function(){var a=this;return e.createElement("i",{"data-stat-key":"bugReport",className:"icon btn icon-alert f-left attachment-downloader",title:f.str_bug_title,onClick:function(){yui.fire("newMessage",{cbfn:function(b){a.reportBug(b)}})}})}}),b.exports=d},{"../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],47:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("StatService"),g=a("./attachment_navigator.jsx");d=e.createClass({displayName:"ControlBox",propTypes:{tbExpandMode:e.PropTypes.string.isRequired,tbItems:e.PropTypes.object},onMouseMove:function(a){this.props.callbacksObj.clearMouseMoveTimer(),a.stopPropagation()},statControlBoxEvents:function(a){var b=a.target.getAttribute("data-stat-key");b&&f.stat({name:"previewr_tb_click",tags:{statKey:b}})},render:function(){var a=this,b=a.props.tbExpandMode,c=[];return c=a.props.tbItems.filter(function(a){return a.infoObj.controlBox===!0}).sort(function(a,b){return a.infoObj.pos>b.infoObj.pos}).map(function(a){return a.markup}),"presentation"!==b?e.createElement("div",{className:"control-box-wrapper"},e.createElement("div",{className:"control-box",onMouseMove:a.onMouseMove,onClick:a.statControlBoxEvents},e.createElement(g,{isDisabled:a.props.activeAtt.isFirstAtt,clickHandler:function(){f.stat({name:"previewr_att_navigator_click",tags:{direction:"prev"}}),a.props.moveActiveAttWrapper(-1)},direction:"prev"}),e.createElement("div",{className:"control-box-inner"},c),e.createElement(g,{isDisabled:a.props.activeAtt.isLastAtt,clickHandler:function(){f.stat({name:"previewr_att_navigator_click",tags:{direction:"next"}}),a.props.moveActiveAttWrapper(1)},direction:"next"}))):null}}),b.exports=d},{"./attachment_navigator.jsx":44,StatService:"StatService","react/addons":"react/addons"}],48:[function(a,b,c){"use strict";var d=a("react/addons"),e=a("../../../../artifacts/lang.js");b.exports=d.createClass({displayName:"exports",propTypes:{setTbExpandMode:d.PropTypes.func},render:function(){var a=this;return d.createElement("i",{title:e.str_hover_expand,"data-stat-key":"expand",className:"icon-expand btn icon f-left expand-btn",onClick:function(){a.props.setTbExpandMode("expanded")}})}})},{"../../../../artifacts/lang.js":2,"react/addons":"react/addons"}],49:[function(a,b,c){"use strict";var d=a("react/addons"),e=a("../../../../artifacts/lang.js");b.exports=d.createClass({displayName:"exports",propTypes:{setTbExpandMode:d.PropTypes.func},render:function(){var a=this,b=d.createElement("i",{title:e.str_hover_fullscreen,"data-stat-key":"presentation",className:"icon-fullscreen f-left btn icon",onClick:function(){a.props.setTbExpandMode("presentation")}});return d.createElement("span",{className:"presentation-btn"},b)}})},{"../../../../artifacts/lang.js":2,"react/addons":"react/addons"
}],50:[function(a,b,c){"use strict";var d=a("react/addons"),e=a("StatService"),f=a("lodash");b.exports=d.createClass({displayName:"exports",getTbMarkup:function(a){var b=this;return b.props.tbItems.filter(function(c){var d=!0,e=b.props.getTbExpandMode(),f=c.infoObj;return d=d&&("all"===f.editMode||b.props.tbEditMode===f.editMode),d=d&&("all"===f.expandMode||e===f.expandMode),d&&a.top<f.pos&&f.pos<=a.bottom}).sort(function(a,b){return a.infoObj.pos-b.infoObj.pos}).map(function(a){return a.markup})},getInitialState:function(){return{mailTab:yui.mail.Tabs.getActiveTab(),domNode:null}},addToolbarCss:function(){var a=this,b=a.props.getTbExpandMode(),c="collapsed"!==b,d=document.body.className,e=d.split(" "),g="";e=f.union(e,["docpreview-on"]),c?e=f.union(e,["docpreview-expanded"]):f.remove(e,function(a){return"docpreview-expanded"===a}),"presentation"===b?e=f.union(e,["docpreview-presentation"]):f.remove(e,function(a){return"docpreview-presentation"===a}),g=e.join(" "),d!==g&&(document.body.className=g)},removeToolbarCss:function(){var a=document.body.className,b=a.split(" ");f.remove(b,function(a){return"docpreview-presentation"===a||"docpreview-expanded"===a||"docpreview-on"===a}),document.body.className=b.join(" ")},componentDidUpdate:function(){this.addToolbarCss()},componentWillUnmount:function(){this.removeToolbarCss(),this.evtHandle&&(this.evtHandle.detach(),this.evtHandle=null)},componentDidMount:function(){var a=this;a.evtHandle=yui.on("tabChange",function(){yui.mail.Tabs.getActiveTab()===a.state.mailTab?setTimeout(function(){a.addToolbarCss()},0):a.removeToolbarCss()}),a.setState({domNode:a.getDOMNode()})},clickHandler:function(a){var b=a.target.getAttribute("data-stat-key");b&&e.stat({name:"previewr_tb_click",tags:{statKey:b}})},render:function(){var a=this;return d.createElement("div",{className:"fresh-toolbar",onClick:a.clickHandler},d.createElement("div",{className:"toolbar-borderdiv"}," "),d.createElement("div",{className:"toolbar-docstyle icon-text"},d.createElement("div",{className:"f-left"},a.getTbMarkup({top:0,bottom:10})),d.createElement("div",{className:"f-right"},a.getTbMarkup({top:30,bottom:40})),d.createElement("div",{className:"toolbar-markup"},a.getTbMarkup({top:10,bottom:30}))))}})},{StatService:"StatService",lodash:"lodash","react/addons":"react/addons"}],51:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../../../../artifacts/lang.js");d=e.createClass({displayName:"ZoomController",mixins:[a("context-mixin")],propTypes:{zoomCbk:e.PropTypes.func.isRequired},getInitialState:function(){var a=this;return a.props.callbacksObj.refreshZoomControls=function(){a.setState({})},{}},render:function(){var a,b,c,d=this;return b="icon btn icon-zoom-in f-right",c="icon btn icon-zoom-out f-left",d.props.callbacksObj.zoomCbk||(b+=" disabled",c+=" disabled"),a=e.createElement("span",null,e.createElement("i",{title:f.str_hover_zoom_out,"data-stat-key":"zoomOut",className:c,"data-action":"zoomout",onClick:function(){d.props.callbacksObj.zoomCbk(-.1)}}),e.createElement("i",{title:f.str_hover_zoom_in,"data-stat-key":"zoomIn",className:b,"data-action":"zoomin",onClick:function(){d.props.callbacksObj.zoomCbk(.1)}}))}}),b.exports=d},{"../../../../artifacts/lang.js":2,"context-mixin":"context-mixin","react/addons":"react/addons"}],52:[function(a,b,c){"use strict";var d,e,f=a("lodash");d=["PREVIEWR_WRAPPER_FETCH_DATA"],e={SPLIT_SCREEN_WIDTH_THRESHOLD:500,FULL_SCREEN_WIDTH_THRESHOLD:1e3},b.exports={mail:f.zipObject(d,d),sizeMap:e}},{lodash:"lodash"}],53:[function(a,b,c){"use strict";var d="DPTYPE_DocIter";b.exports={propTypes:{attachments:React.PropTypes.object.isRequired},getActiveAtt:function(){var a=this.props.attachments,b=[];return Array.isArray(a)?b=a.filter(function(a){return a.active}):a.type===d&&(b=[a.getActive()]),b.map(function(a){return{isFirstAtt:a.isFirstAtt,isLastAtt:a.isLastAtt,downloadInfo:a.downloadInfo,filetype:a.filetype,filename:a.filename,mimetype:a.mimetype,docUrl:a.fullsize||"",docId:a.documentId}})[0]},moveActiveAtt:function(a,b){var c,e,f=this,g=this.props.attachments;if(Array.isArray(g)){for(c=0;c<g.length;c++)if(g[c].active&&g[c+a])return f.resetTbItems(),e=c,g[c].active=!1,g[c+a].active=!0,f.callbacksObj.zoomCbk=null,f.callbacksObj.refreshZoomControls(),void f.setState({activeAtt:f.getActiveAtt()},b)}else g.type===d&&(0>a&&g.hasPrevious()||g.hasNext())&&(0>a?g.previous():g.next(),f.resetTbItems(),f.callbacksObj.zoomCbk=null,f.callbacksObj.refreshZoomControls(),f.setState({activeAtt:f.getActiveAtt()},b))},getPart:function(a){var b=this,c=b.props.msgObj.part,d=0;for(d=0;d<c.length;d++)if(c[d].partId===a)return c[d]},downloadActiveAttForArray:function(){var a=this,b=a.state.activeAtt.downloadInfo,c=document.createElement("iframe"),d=a.getDOMNode(),e=a.getPart(b.pid),f=e.downloadUrlV3||e.downloadUrl;c.height=0,c.width=0,c.src=f,c.style.display="none",d.appendChild(c)},downloadActiveAttForIterator:function(){var a=this,b=document.createElement("iframe"),c=this.props.attachments,d=a.getDOMNode();c.getDownloadUrlOfActiveItem(function(a){b.height=0,b.width=0,b.src=a,b.style.display="none",d.appendChild(b)})},downloadActiveAtt:function(){var a=this.props.attachments;Array.isArray(a)?this.downloadActiveAttForArray():a.type===d&&this.downloadActiveAttForIterator()},getInitialState:function(){var a=this.props.attachments;return Array.isArray(a)&&(a[0].isFirstAtt=!0,a[a.length-1].isLastAtt=!0),{activeAtt:this.getActiveAtt()}}}},{}],54:[function(a,b,c){"use strict";var d,e,f="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element;d=function(){for(var a,b,c=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],d=0,e=c.length,f={};e>d;d++)if(a=c[d],a&&a[1]in document){for(d=0,b=a.length;b>d;d++)f[c[0][d]]=a[d];return f}return!1}(),e={request:function(a){var b=d.requestFullscreen;a=a||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?a[b]():a[b](f&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[d.exitFullscreen]()},toggle:function(a){this.isFullscreen?this.exit():this.request(a)},raw:d},d||(b.exports=!1),Object.defineProperties(e,{isFullscreen:{get:function(){return!!document[d.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[d.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[d.fullscreenEnabled]}}}),b.exports=e},{}],55:[function(a,b,c){"use strict";var d=a("../../core/constants/previewr_core_constants.js").mail,e=a("./fullscreen_mixin.js"),f=a("../constants/previewr_wrapper_constants.js").sizeMap;b.exports={propTypes:{container:React.PropTypes.element.isRequired},getInitialState:function(){var a=d.zoomType.INFINITE_SCROLL;return this.props.container.isFullScreenContainer&&(a=d.zoomType.PRESENTATION),{tbItems:[],tbEditMode:"normal",zoomType:a,tbExpandMode:"collapsed",iframe:this.props.container.getDOMNode().querySelector("iframe").contentDocument}},tbExpandModeChangeHandler:function(){var a=this,b=a.props.container,c=a.state.tbExpandMode,f="collapsed"===c?50:100,g=b.getDOMNode();b.resize(f),"presentation"===c?(g.style.top="0px",g.style.paddingTop="5px",e?e.request(g):a.state.iframe.addEventListener("keyup",a.presentationEscListener),setTimeout(function(){a.setState({zoomType:d.zoomType.PRESENTATION})},1e3)):(g.style.top="",g.style.paddingTop="",a.setState({zoomType:d.zoomType.INFINITE_SCROLL}))},addToolBarItem:function(a,b){var c=this.state.tbItems;b=b||{},b.pos=b.pos||40,b.editMode=b.mode||"all",b.expandMode=b.expandMode||"all",c.push({markup:a,infoObj:b}),this.setState({tbItems:c})},getTbExpandMode:function(){return this.state.tbExpandMode},setTbExpandMode:function(a){var b=this;b.setState({tbExpandMode:a},function(){b.tbExpandModeChangeHandler(),clearTimeout(b.mouseOverTimer),b.mouseOverTimer=null})},expandOrCollapseTable:function(a){var b,c,d=["close","collapsed","expanded","presentation"],e=this.getTbExpandMode(),g=this.getDOMNode().clientWidth;g<f.FULL_SCREEN_WIDTH_THRESHOLD&&"expanded"===e&&d.splice(1,1),b=d.indexOf(e),c=d[b+a],c&&("close"===c?this.props.container.requestClose():this.setTbExpandMode(c))},resetTbStore:function(){this.setState({tbItems:[],tbEditMode:"normal",tbExpandMode:"collapsed"})},resetTbItems:function(a){this.setState({tbItems:[]},a)}}},{"../../core/constants/previewr_core_constants.js":35,"../constants/previewr_wrapper_constants.js":52,"./fullscreen_mixin.js":54}],56:[function(a,b,c){function d(a,b,c){var d=a.getElementById(b);if(d)c(d);else{var e=a.getElementsByTagName("head")[0];d=a.createElement("style"),d.id=b,c(d),e.appendChild(d)}return d}b.exports=function(a,b,c){var e=b||document;if(e.createStyleSheet){var f=e.createStyleSheet();return f.cssText=a,f.ownerNode}return d(e,c,function(b){b.styleSheet?b.styleSheet.cssText=a:b.innerHTML=a})},b.exports.byUrl=function(a){if(document.createStyleSheet)return document.createStyleSheet(a).ownerNode;var b=document.getElementsByTagName("head")[0],c=document.createElement("link");return c.rel="stylesheet",c.href=a,b.appendChild(c),c}},{}],57:[function(a,b,c){"use strict";function d(a){this.dispatcher=a,this._hasChanged=!1,this.initialize&&this.initialize()}var e=a("util"),f=a("events").EventEmitter,g="change";e.inherits(d,f),d.prototype.getContext=function(){return this.dispatcher.getContext()},d.prototype.addChangeListener=function(a){this.on(g,a)},d.prototype.removeChangeListener=function(a){this.removeListener(g,a)},d.prototype.shouldDehydrate=function(){return this._hasChanged},d.prototype.emitChange=function(a){this._hasChanged=!0,this.emit(g,a||this)},b.exports=d},{events:"events",util:60}],58:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],59:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],60:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)D(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),D(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var E=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(E,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation,g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var F,G={};c.debuglog=function(a){if(v(F)&&(F=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!G[a])if(new RegExp("\\b"+a+"\\b","i").test(F)){b.pid;G[a]=function(){c.format.apply(c,arguments)}}else G[a]=function(){};return G[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");c.log=function(){},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":59,_process:58,inherits:61}],61:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],FilePreviewr:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("../constants/previewr_core_constants.js").mail,g=a("./file_previewr_factory.js"),h=a("StatService");d=e.createClass({displayName:"FilePreviewr",propTypes:{docData:e.PropTypes.object,callbacksObj:e.PropTypes.object.isRequired,zoomType:e.PropTypes.string,expandMode:e.PropTypes.string},getDefaultProps:function(){return{docData:null,expandMode:"collapsed",zoomType:f.zoomType.INFINITE_SCROLL}},getViewType:function(a){var b,c=this,d=c.props,e=d.docData&&d.docData.mimetype;return a=a.toLowerCase(),b=f.viewsmap[a]?f.viewsmap[a]:f.views.VIEWER_UNSUPPORTED,d.docData.docId||b===f.views.VIEWER_IMAGE||(b=f.views.VIEWER_UNSUPPORTED,h.stat({name:"previewr_documentid_null",tags:{filetype:a,mimetype:e}})),d.isZipEnabled||b===f.views.VIEWER_ZIP&&(b=f.views.VIEWER_UNSUPPORTED),b},componentDidMount:function(){var a=this,b=a.props.docData&&a.props.docData.filetype,c=a.getViewType(b),d=a.props.docData&&a.props.docData.mimetype;h.stat({name:"previewr_attachment_open",tags:{viewType:c,filetype:b,mimetype:d}})},render:function(){var a=this,b=a.props.docData&&a.props.docData.filetype,c=a.getViewType(b),d=e.createElement(g[c],{mimetype:a.props.docData&&a.props.docData.mimetype,filetype:b,docUrl:a.props.docData&&a.props.docData.docUrl,docId:a.props.docData&&a.props.docData.docId,zoomType:a.props.zoomType,expandMode:a.props.expandMode,zipMode:a.props.zipMode,callbacksObj:a.props.callbacksObj,isSheetsViewEnabled:a.props.isSheetsViewEnabled,fileName:a.props.fileName});return e.createElement("div",{className:"viewer-wrapper"},d)}}),b.exports=d},{"../constants/previewr_core_constants.js":35,"./file_previewr_factory.js":18,StatService:"StatService","react/addons":"react/addons"}],PreviewrWrapper:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("./toolbar.jsx"),g=a("./back_button.jsx"),h=a("./expand_button.jsx"),i=a("./zoom_controller.jsx"),j=a("./presentation_btn.jsx"),k=a("./attachment_downloader.jsx"),l=a("./bug_report_button.jsx"),m=a("./control_box.jsx"),n=a("FilePreviewr"),o=a("context-mixin"),p=a("../../mixins/TimeoutMixin"),q=a("../actions/previewr_wrapper_actions.js"),r=a("../mixins/toolbar_mixin.js"),s=a("../mixins/attachments_mixin.js"),t=a("../../../../artifacts/lang.js"),u=a("../../utils/keyboard");d=e.createClass({displayName:"PreviewrWrapper",mixins:[o,r,s,p],propTypes:{msgObj:e.PropTypes.object,attachments:e.PropTypes.object},callbacksObj:{},mouseOverTimer:null,controlBoxState:!1,keyboardUtil:new u,addDocTitle:function(){var a=this,b=a.state.activeAtt.filename,c=e.createElement("span",{className:"doc-title f-left"},e.createElement("span",{"data-stat-key":"fileName",className:"file-name",title:b},b)),d="all";a.zipNavigatorEnable&&(d="expanded"),a.addToolBarItem(c,{pos:2,expandMode:d})},addBugReporter:function(){var a=this;a.addToolBarItem(e.createElement(l,{msgObj:a.props.msgObj,activeAtt:a.state.activeAtt}),{pos:37})},addDownloadBtn:function(){var a=this;a.addToolBarItem(e.createElement(k,{downloadActiveAtt:a.downloadActiveAtt}),{controlBox:!1,expandMode:"all",pos:38})},addZoomControls:function(){var a=this;a.addToolBarItem(e.createElement(i,{callbacksObj:a.callbacksObj}),{pos:4,controlBox:!0,expandMode:"none"})},addResizeBtn:function(){var a=this;a.addToolBarItem(e.createElement(g,{setTbExpandMode:a.setTbExpandMode,getTbExpandMode:a.getTbExpandMode,cont:a.props.container,msgObj:a.props.msgObj,zipNavigatorEnable:a.props.zipNavigatorEnable}),{pos:1}),a.addToolBarItem(e.createElement(h,{setTbExpandMode:a.setTbExpandMode}),{pos:39,expandMode:"collapsed"}),a.addToolBarItem(e.createElement(j,{setTbExpandMode:a.setTbExpandMode}),{pos:39,expandMode:"expanded"})},addCloseBtn:function(){var a=this,b=a.props.container,c=e.createElement("i",{title:t.str_hover_close,"data-stat-key":"close",className:"icon btn icon-close f-left close-btn",onClick:function(){a.addSetTimeout(setTimeout(function(){b.requestClose()},1))}});a.addToolBarItem(c,{pos:40})},resetZipNavigatorFlags:function(){this.zipNavigatorEnable=!1},getInitialState:function(){var a=this;return a.zipNavigatorEnable=!1,a.callbacksObj.downloadAtt=a.downloadActiveAtt,a.callbacksObj.fetchAction=a.fetchAction,a.callbacksObj.addToolbarItem=a.addToolBarItem,a.callbacksObj.addDefaultTBItems=a.addDefaultTBItems,a.callbacksObj.resetTbItems=a.resetTbItems,a.callbacksObj.refreshZoomControls=null,a.callbacksObj.zoomCbk=null,a.callbacksObj.clearMouseMoveTimer=a.clearMouseMoveTimer,a.callbacksObj.setZipNavigator=function(b,c){a.zipNavigatorEnable=b,a.addSetTimeout(setTimeout(function(){a.resetTbItems(function(){a.addDefaultTBItems(),"function"==typeof c&&c()})},0))},a.resetTbItems(),{}},componentWillUnmount:function(){this.clearMouseMoveTimer()},componentDidMount:function(){var a=this,b=a.keyboardUtil;b.addAction({keyCode:b.constants.ESC},a._gotoPreviousPreviewMode),b.addAction({keyCode:b.constants.KEY_F,ctrlKey:!0},a._gotoNextPreviewMode),b.addAction({keyCode:b.constants.LEFT},a._previewPreviousAttachment),b.addAction({keyCode:b.constants.RIGHT},a._previewNextAttachment),a.addDefaultTBItems(),a.addSetTimeout(setTimeout(function(){a.getDOMNode().focus()},100))},addDefaultTBItems:function(){var a=this;a.addDownloadBtn(),a.props.container.isFullScreenContainer||a.addResizeBtn(),a.addCloseBtn(),a.addDocTitle(),a.addZoomControls(),NeoConfig.isCorpmail&&a.addBugReporter()},fetchAction:function(a){var b=this;b.context.executeAction(q.fetchPreviewData,a)},clearMouseMoveTimer:function(){var a=this;clearTimeout(a.mouseOverTimer),a.mouseOverTimer=null},onMouseMove:function(){var a=this;"presentation"!==a.getTbExpandMode()&&(a.mouseOverTimer||(a.controlBoxState=!0,a.getDOMNode().className+=" show-control-box"),a.clearMouseMoveTimer(),a.mouseOverTimer=setTimeout(function(){var b=a.getDOMNode();a.mouseOverTimer=null,b.className=b.className.replace(/ show-control-box/g,""),a.controlBoxState=!1},3e3))},_gotoPreviousPreviewMode:function(){this.expandOrCollapseTable(-1)},_gotoNextPreviewMode:function(a){this.expandOrCollapseTable(1),a.e.preventDefault()},_previewNextAttachment:function(){this.resetZipNavigatorFlags(),this.moveActiveAttWrapper(1)},_previewPreviousAttachment:function(){this.resetZipNavigatorFlags(),this.moveActiveAttWrapper(-1)},onKeyDown:function(a){var b=this,c=b.keyboardUtil;c.triggerAction(a,{e:a})},moveActiveAttWrapper:function(a){var b=this;b.moveActiveAtt(a,function(){b.addDefaultTBItems(),b.clearMouseMoveTimer(),b.getDOMNode().focus()})},render:function(){var a=this,b="previewr-wrapper "+a.getTbExpandMode(),c=a.state.activeAtt.downloadInfo&&a.state.activeAtt.downloadInfo.aid||"0";return a.controlBoxState&&(b+=" show-control-box"),e.createElement("div",{key:c,onKeyDown:a.onKeyDown,onMouseMove:a.onMouseMove,className:b,tabIndex:"0"},e.createElement(f,{tbItems:a.state.tbItems,tbEditMode:a.state.tbEditMode,getTbExpandMode:a.getTbExpandMode}),e.createElement(m,{tbItems:a.state.tbItems,tbExpandMode:a.getTbExpandMode(),activeAtt:a.state.activeAtt,moveActiveAttWrapper:a.moveActiveAttWrapper,callbacksObj:a.callbacksObj}),e.createElement(n,{callbacksObj:a.callbacksObj,docData:a.state.activeAtt,zoomType:a.state.zoomType,expandMode:a.getTbExpandMode(),zipMode:a.zipNavigatorEnable,isZipEnabled:a.props.isZipEnabled,isSheetsViewEnabled:a.props.isSheetsViewEnabled,fileName:a.state.activeAtt.filename}))}}),b.exports=d},{"../../../../artifacts/lang.js":2,"../../mixins/TimeoutMixin":39,"../../utils/keyboard":40,"../actions/previewr_wrapper_actions.js":42,"../mixins/attachments_mixin.js":53,"../mixins/toolbar_mixin.js":55,"./attachment_downloader.jsx":43,"./back_button.jsx":45,"./bug_report_button.jsx":46,"./control_box.jsx":47,"./expand_button.jsx":48,"./presentation_btn.jsx":49,"./toolbar.jsx":50,"./zoom_controller.jsx":51,FilePreviewr:"FilePreviewr","context-mixin":"context-mixin","react/addons":"react/addons"}]},{},[37]);!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=".full-overlay{position:absolute;left:0;top:0;bottom:0;right:0;opacity:.5;background:#000}.full-screen{z-index:9999999;bottom:0;right:0;top:0;left:0;position:fixed}.center-dialog{width:800px;height:580px;position:absolute;left:0;top:0;bottom:0;right:0;margin:auto}.center-dialog .contact-dialog-outer{left:0;right:0;position:absolute;top:0;bottom:0;color:#000;display:block;width:auto;opacity:1}.important-setting-dialog{display:table;height:100%;width:100%}.important-setting-dialog .scroll-content{padding:10px 0}.important-setting-dialog .left-dialog{width:365px;padding:15px 15px 15px 18px;border-right:1px solid rgba(29,63,122,.2)}.important-setting-dialog .left-dialog .important-item{margin-bottom:0;border:1px solid #f1f1f1;border-top:0;cursor:pointer}.important-setting-dialog .left-dialog .scroll-content{overflow-x:hidden}.important-setting-dialog .important-item:hover{background-color:#F2F2F2}.important-setting-dialog .menu-active-item{background-color:#F2F2F2!important}.important-setting-dialog .right-dialog{padding:15px 18px 0 18px;width:365px;height:400px;overflow:auto;position:relative}.important-setting-dialog .right-dialog .important-item{margin-bottom:5px;border:1px solid #f1f1f1}.important-setting-dialog .right-dialog .confirm-modal{position:absolute;left:0;top:0;bottom:0;right:0;background-color:rgba(255,255,255,.8);text-align:center}.important-setting-dialog .right-dialog .confirm-modal .modal-title{margin-top:60px}.important-setting-dialog .right-dialog .confirm-modal .modal-desc{margin-top:5px}.important-setting-dialog .right-dialog .confirm-modal .modal-btns{margin-top:10px}.important-setting-dialog .right-dialog .confirm-modal .modal-btns button{height:23px;line-height:20px;padding:0 10px}.important-setting-dialog .right-top-btns{height:23px;padding:6px 0}.important-setting-dialog .right-top-btns button{height:23px;line-height:20px;padding:0 5px}.important-setting-dialog .important-input{width:100%;border:none;outline:0;padding-left:8px}.important-setting-dialog .icon-add{width:18px;height:25px;line-height:25px;font-size:17px;background-color:#157cfb;color:#fff;margin:3px;padding-left:5px;border-radius:2px}.important-setting-dialog .important-item{width:100%;position:relative;height:40px;color:#000;margin-bottom:1px}.important-setting-dialog .important-typeahead-container{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:30px;border:1px solid #907cf6}.important-setting-dialog .important-main{display:table;width:100%}.important-setting-dialog .important-detail,.important-setting-dialog .important-img{display:table-cell}.important-setting-dialog .important-detail{padding-left:5px}.important-setting-dialog .important-img{width:40px;min-width:40px;-webkit-transform:translate(-1px,-1px);-moz-transform:translate(-1px,-1px);transform:translate(-1px,-1px)}.important-setting-dialog .placeholder-icon{z-index:0;text-align:center;position:absolute;width:40px;border-radius:3px;font-size:1.4rem;line-height:40px;color:#fff;margin:0;padding:0;height:40px;top:0}.important-setting-dialog .placeholder-icon-keyword{font-family:mail}.important-setting-dialog .header-title .icon-close{position:absolute;right:12px;top:13px}.important-setting-dialog .important-remove{display:none;outline:0}.important-setting-dialog .important-item:hover .important-remove{display:table-cell;width:auto;border:none;background:0 0;right:5px;top:10px;position:absolute;color:grey;cursor:pointer;font-family:mail;font-size:.9em}.important-setting-dialog .important-second-line{color:#999;font-size:13px;text-overflow:elipsis;height:20px;vertical-align:bottom;overflow:hidden;white-space:nowrap}.important-setting-dialog .important-contact-img{width:40px;height:40px;display:block;background-size:contain;position:absolute;top:0}.important-setting-dialog .important-first-line{height:20px;vertical-align:top;text-overflow:elipsis;overflow:hidden;white-space:nowrap}.important-setting-dialog .contact-dialog-content{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:100%;width:100%}.important-setting-dialog .contact-dialog-footer,.important-setting-dialog .contact-dialog-header{display:table-row;height:1px}.important-setting-dialog .header-title{padding:20px 50px 20px 20px}.important-setting-dialog .footer-buttons{padding:23px}";a("./../../../jarvis/node_modules/cssify")(d,void 0,"/var/builds/workspace/49935-v3-package/BUILD_CONTAINER/container/label/DOCKER-LOW/app_root/artifacts/css/main.css"),b.exports=d},{"./../../../jarvis/node_modules/cssify":17}],2:[function(a,b,c){var d={str_cancel:"Cancel",str_clear_list:"Clear list",str_close:"Close",str_important_add_contact_keyword:"Add Contact/Keyword",str_important_desc:"Edit your important contacts and keywords",str_important_header_num_contact_keyword:"{{contactsNum}} contact, {{keywordNum}} keyword",str_important_header_num_contact_keywords:"{{contactsNum}} contact, {{keywordNum}} keywords",str_important_header_num_contacts_keyword:"{{contactsNum}} contacts, {{keywordNum}} keyword",str_important_header_num_contacts_keywords:"{{contactsNum}} contacts, {{keywordNum}} keywords",str_important:"Important",str_keyword:"Keyword",str_no:"No",str_reset_to_default_modal_desc_contact_keywords:"You have {{contactsNum}} contact and {{keywordNum}} keywords in the list.",str_reset_to_default_modal_desc_contact_keyword:"You have {{contactsNum}} contact and {{keywordNum}} keyword in the list.",str_reset_to_default_modal_desc_contacts_keywords:"You have {{contactsNum}} contacts and {{keywordNum}} keywords in the list.",str_reset_to_default_modal_desc_contacts_keyword:"You have {{contactsNum}} contacts and {{keywordNum}} keyword in the list.",str_reset_to_default_modal_title:"Do you want to reset this list?",str_reset_to_default:"Reset to defaults",str_save:"Save",str_suggestion_email_singular:"{{emailAddress}}",str_suggestion_other_email_plural:"{{emailAddress}} & {{number}} more emails",str_suggestion_other_email_singular:"{{emailAddress}} & 1 more email",str_yes:"Yes",last:null};b.exports=d},{}],3:[function(a,b,c){"use strict";function d(a){return(a||[]).map(function(a){return"PEOPLE"===a.intent?a.emailAddresses.map(function(a){return"fromEmail:"+a}).join(" "):a.displayStr}).join(" ")}function e(a){l.set("importantSearches",JSON.stringify(a)),l.set("importantQuery",d(a)),l.save()}function f(){return new i({bucketId:NeoConfig.expBucketId,wssid:NeoConfig.wssid,mailboxId:NeoConfig.V3MailboxId,isForceUser:NeoConfig.forceDS,imapInEnabled:NeoConfig.imapIn,hasMultipleAccounts:NeoConfig.hasMultipleAccounts,searchResultsLinksEnabled:yui.common.Utils.features.enabled("searchResultsLinks"),lmv3Enabled:yui.common.Utils.features.enabled("LMV3"),bcHost:yui.common.Utils.settings.value("bootcamp_psearch_url","https://prod1psearch.mail.yahoo.com")})}var g,h=a("../constants/ImportantConstants"),i=a("BootcampAPIUtilsV2"),j=a("../utils/Utils.js").parseImportantContacts,k=a("../utils/APIUtils").fetchTopContactsSuggestions,l=yui.mail.persist.MetaData,m={};g={fetchSuggestions:function(a,b){var c={keyword:b.keyword},d=f();a.dispatch(h.CONTACT_FETCH_INIT,b),d.getSuggestions({reqId:yui.common.net.Session.genReqID(),query:b.keyword,suggestionsCache:m}).then(function(b){a.dispatch(h.CONTACT_FETCH_SUCCESS,{query:c,data:b.data})},function(b){800!==b.status&&a.dispatch(h.CONTACT_FETCH_FAIL,{query:c,data:[]})})},fetchImportantSearch:function(a){yui.use("mail-persist-meta-data",function(){var b=j();b?a.dispatch(h.IMPORTANT_SEARCH_UPDATE,b):k().then(function(b){e(b),a.dispatch(h.IMPORTANT_SEARCH_UPDATE,b)})})},resetToTopImportantContact:function(a){k().then(function(b){a.dispatch(h.IMPORTANT_SEARCH_UPDATE,b)})},clearImportantContact:function(a){a.dispatch(h.IMPORTANT_SEARCH_CLEAR)},removeImportantSearch:function(a,b){a.dispatch(h.IMPORTANT_SEARCH_REMOVE,b)},addImportantSearch:function(a,b){a.dispatch(h.IMPORTANT_SEARCH_ADD,b)},saveImportantSearch:function(a,b){e(b)}},b.exports=g},{"../constants/ImportantConstants":10,"../utils/APIUtils":15,"../utils/Utils.js":16,BootcampAPIUtilsV2:"BootcampAPIUtilsV2"}],4:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("Context");d=e.createClass({displayName:"CenterDialogBox",mixins:[f],render:function(){return e.createElement("div",{className:"center-dialog"},this.props.children)}}),b.exports=d},{Context:"Context","react/addons":"react/addons"}],5:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("Context");d=e.createClass({displayName:"FullScreenOverlay",mixins:[f],componentWillMount:function(){var a=this;a.container=document.createElement("div")},componentDidMount:function(){var a=this,b=a.container;a.overlay=e.render(e.createElement("div",{className:"full-screen"},e.createElement("div",{className:"full-overlay",onClick:a.props.handleClose}),this.props.children),b),document.body.appendChild(b)},componentWillUnmount:function(){var a=this,b=a.container;e.unmountComponentAtNode(b),document.body.removeChild(b)},render:function(){return e.createElement("div",null)}}),b.exports=d},{Context:"Context","react/addons":"react/addons"}],6:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("Context"),g=a("./FullScreenOverlay.jsx"),h=a("./CenterDialogBox.jsx"),i=a("./MainDialog.jsx");d=e.createClass({displayName:"ImportantSetupContainer",getInitialState:function(){return{isOverlayOpen:!1}},mixins:[f],_yuiEvents:[],componentDidMount:function(){this._yuiEvents=[],this._yuiEvents.push(yui.on("simple-important:settings",this.handleOpen))},componentWillUnmount:function(){var a=this;a._yuiEvents.forEach(function(a){a.detach()})},render:function(){return this.state.isOverlayOpen?e.createElement(g,{handleClose:this.handleClose},e.createElement(h,null,e.createElement(i,{handleClose:this.handleClose}))):null},handleOpen:function(){this.setState({isOverlayOpen:!0})},handleClose:function(){this.setState({isOverlayOpen:!1})}}),b.exports=d},{"./CenterDialogBox.jsx":4,"./FullScreenOverlay.jsx":5,"./MainDialog.jsx":7,Context:"Context","react/addons":"react/addons"}],7:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("Context"),g=a("lodash"),h=a("DOMUtils"),i=a("../../../artifacts/lang"),j=a("../actions/ImportantActions"),k=a("./Suggestion.jsx"),l=a("../models/ImportantEntry"),m=a("./Modal.jsx"),n=a("../stores/ImportantContactSuggestionsStore"),o=a("../stores/ImportantContactsStore"),p=a("ListNavigation"),q=a("StatService"),r=a("Template");d=e.createClass({displayName:"MainDialog",mixins:[f,p],minIndex:-1,newItemAdded:!1,getInitialState:function(){var a=this.getStore(o).get();return{contactSuggestions:[],inputValue:"",modalState:null,selectedIndex:-1,contacts:a,initialSearches:a}},componentWillMount:function(){var a=this;setTimeout(function(){a.executeAction(j.fetchImportantSearch)},0)},componentDidMount:function(){this.getStore(n).on("changed",this.updateContactSuggestions),this.getStore(o).on("changed",this.updateContacts),q.stat({name:"important_setting_launch"})},componentWillUnmount:function(){this.getStore(n).removeListener("changed",this.updateContactSuggestions),this.getStore(o).removeListener("changed",this.updateContacts),q.stat({name:"important_setting_close"})},componentDidUpdate:function(){var a,b=this,c=b.state;b.newItemAdded&&c.contacts.length&&(b.newItemAdded=!1,a=b.refs.importantContactList.getDOMNode(),a=a&&a.querySelector(".important-item:last-child"),a&&a.scrollIntoView(!1))},render:function(){var a,b=this,c=e.addons.classSet({"scroll-content":!0}),d=this.state.contacts.filter(function(a){return"PEOPLE"===a.intent}).length||0,f=this.state.contacts.filter(function(a){return"KEYWORD"===a.intent}).length||0;return a=1!==d&&1!==f?i.str_important_header_num_contacts_keywords:1===d&&1!==f?i.str_important_header_num_contact_keywords:1!==d&&1===f?i.str_important_header_num_contacts_keyword:i.str_important_header_num_contact_keyword,e.createElement("div",{className:"contact-dialog-outer modal"},e.createElement("div",{className:"important-setting-dialog modal-settings"},e.createElement("div",{className:"contact-dialog-header"},e.createElement("div",{className:"header-title"},e.createElement("h2",null,i.str_important),e.createElement("h3",null,i.str_important_desc),e.createElement("span",{className:"icon icon-close",title:i.str_close,onClick:b.onCancel}))),e.createElement("div",{className:"contact-dialog-content modal-bd"},e.createElement("div",{className:"left-dialog"},e.createElement("div",{className:"important-typeahead-container"},e.createElement("input",{value:b.state.inputValue,onKeyDown:b.onKeyDown,className:"important-input",placeholder:i.str_important_add_contact_keyword,onChange:b.handleInputChange}),e.createElement("span",{className:"icon icon-add",onClick:b.addKeywordSearch})),e.createElement("ul",null,b.state.contactSuggestions.map(function(a,c){return e.createElement(k,{data:a,isSelected:c===b.state.selectedIndex,onClick:b.onPersonClick.bind(b,a),inputValue:b.state.inputValue})}))),e.createElement("div",{className:"right-dialog"},e.createElement("div",null,e.createElement(r,{contactsNum:d,keywordNum:f,tmpl:a})),e.createElement("div",{className:"right-top-btns"},e.createElement("button",{className:"btn",onClick:b.openModal.bind(b,"default")},i.str_reset_to_default),e.createElement("button",{className:"btn",onClick:b.openModal.bind(b,"clear")},i.str_clear_list)),e.createElement("ul",{ref:"importantContactList",className:c},b.state.contacts.map(function(a,c){return e.createElement(k,{data:a,onClick:g.noop,onRemove:b.onRemove.bind(b,c),inputValue:""})})),b.renderConfirmModal(d,f))),e.createElement("div",{className:"contact-dialog-footer"},e.createElement("div",{className:"footer-buttons"},e.createElement("button",{type:"button",onClick:b.onSave,className:"btn default"},i.str_save),e.createElement("button",{type:"button",onClick:b.onCancel,className:"btn"},i.str_cancel)))))},openModal:function(a){this.setState({modalState:a})},renderConfirmModal:function(a,b){var c,d=this,f=d.state.modalState;return f?(c=1!==a&&1!==b?i.str_reset_to_default_modal_desc_contacts_keywords:1===a&&1!==b?i.str_reset_to_default_modal_desc_contact_keywords:1!==a&&1===b?i.str_reset_to_default_modal_desc_contacts_keyword:i.str_reset_to_default_modal_desc_contact_keyword,e.createElement(m,{titleStr:i.str_reset_to_default_modal_title,descStr:g.template(c,null)({contactsNum:a,keywordNum:b}),onYes:d.modalYes,onNo:d.closeModal})):null},modalYes:function(){var a=this;switch(a.state.modalState){case"clear":a.onClear(),a.closeModal();break;case"default":a.onReset(),a.closeModal()}},closeModal:function(){this.setState({modalState:null})},onCancel:function(){var a=this;a.props.handleClose(),q.stat({name:"important_setting_cancel"})},onSave:function(){var a=this;a.executeAction(j.saveImportantSearch,a.state.contacts),a.props.handleClose(),q.stat({name:"important_setting_save"})},onReset:function(){var a=this;a.executeAction(j.resetToTopImportantContact),q.stat({name:"important_setting_reset"})},onClear:function(){this.executeAction(j.clearImportantContact)},addKeywordSearch:function(){var a=this,b=this.state.inputValue;a.executeAction(j.addImportantSearch,new l({displayStr:b,intent:"KEYWORD"})),a.newItemAdded=!0,a._reset()},onKeyDown:function(a){var b=this,c=b.state.selectedIndex;switch(a.key){case"Enter":-1===b.state.selectedIndex?b.addKeywordSearch():b.onPersonClick(b.state.contactSuggestions[c]),h.halt(a);break;case"ArrowUp":b.navigateUp(),h.halt(a);break;case"ArrowDown":b.navigateDown(),h.halt(a)}},_reset:function(){this.setState({inputValue:"",contactSuggestions:[]})},onRemove:function(a){var b=this;b.executeAction(j.removeImportantSearch,{index:a})},getItems:function(){return this.state.contactSuggestions},onPersonClick:function(a){var b=this;b.executeAction(j.addImportantSearch,a),b.newItemAdded=!0,b._reset()},updateContacts:function(){this.setState({contacts:this.getStore(o).get()})},updateContactSuggestions:function(){var a=this,b=this.getStore(n).get().filter(function(b){return!g.find(a.state.contacts,function(a){return a.serviceId===b.serviceId})});this.setState({contactSuggestions:b,selectedIndex:-1})},handleInputChange:function(a){var b=this,c=a.currentTarget.value;b.executeAction(j.fetchSuggestions,{keyword:c}),b.setState({inputValue:c})}}),b.exports=d},{"../../../artifacts/lang":2,"../actions/ImportantActions":3,"../models/ImportantEntry":12,"../stores/ImportantContactSuggestionsStore":13,"../stores/ImportantContactsStore":14,"./Modal.jsx":8,"./Suggestion.jsx":9,Context:"Context",DOMUtils:"DOMUtils",ListNavigation:"ListNavigation",StatService:"StatService",Template:"Template",lodash:"lodash","react/addons":"react/addons"}],8:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("Context"),g=a("../../../artifacts/lang");d=e.createClass({displayName:"Modal",mixins:[f],render:function(){var a=this.props;return e.createElement("div",{className:"confirm-modal"},e.createElement("h2",{className:"modal-title"},a.titleStr),e.createElement("h4",{className:"modal-desc"},a.descStr),e.createElement("div",{className:"modal-btns"},e.createElement("button",{className:"btn",onClick:a.onYes},g.str_yes),e.createElement("button",{className:"btn",onClick:a.onNo},g.str_no)))}}),b.exports=d},{"../../../artifacts/lang":2,Context:"Context","react/addons":"react/addons"}],9:[function(a,b,c){"use strict";var d,e=a("react/addons"),f=a("lodash"),g=a("StringUtils"),h=a("Context"),i=a("../../../artifacts/lang");d=e.createClass({displayName:"Suggestion",mixins:[h],boldify:function(a,b){var c=g.indexOfIgnoreCase(a,b),d=a.substr(0,c),f=a.substr(c+b.length),h=a.substr(c,b.length);return c>=0?e.createElement("span",null,d,e.createElement("b",{className:"Fw-b"},h),f):e.createElement("span",{className:"Va-m"},a)},render:function(){var a=this,b=a.props.data,c=a.props.inputValue,d=b.imageUrl,f={backgroundImage:"url("+d+")"},g=e.addons.classSet({"menu-active-item":a.props.isSelected,"important-item":!0});return e.createElement("div",{className:g},e.createElement("div",{className:"important-main","data-id":b.displayStr,ref:"suggestion",onClick:a.props.onClick},e.createElement("div",{className:"important-img"},a.renderPlaceHolderStyle(),e.createElement("span",{style:f,className:"important-contact-img"})),e.createElement("div",{className:"important-detail"},e.createElement("div",{className:"important-first-line",ref:"name"},a.boldify(b.displayStr,c)),a.renderSecondLine())),a.renderRemoveButton())},renderSecondLine:function(){var a,b=this,c=b.props.data,d=b.props.inputValue;return a="KEYWORD"===c.intent?i.str_keyword:b.boldify(b.getPersonSecondLine(),d),e.createElement("div",{"aria-label":"contact suggestion",className:"important-second-line"},a)},renderPlaceHolderStyle:function(){var a=this,b=a.props.data,c={backgroundColor:a.getRandomPersonColor(b.displayStr)};return"PEOPLE"===b.intent?e.createElement("span",{style:c,className:"placeholder-icon"},b.getInitials()):e.createElement("span",{style:c,className:"placeholder-icon placeholder-icon-keyword icon-search"})},renderRemoveButton:function(){return this.props.onRemove?e.createElement("button",{className:"important-remove icon-close",onClick:this.props.onRemove}):null},getRandomPersonColor:function(a){function b(a,b){return(a%b+b)%b}var c=g.hashCode(a),d=["#940050","#CC008C","#BE0067","#F80E5D","#FE4E4D","#FD6867","#FF1032","#FF8C13","#FF530E","#FA0027"];return d[b(c,d.length)]},getPersonSecondLine:function(){var a,b,c=this,d=c.props.data.emailAddresses||[],e=c.props.inputValue,h=f.find(d,function(a){return g.containsIgnoreCase(a,e)})||d[0];switch(d.length){case 0:a="";break;case 1:a=i.str_suggestion_email_singular;break;case 2:a=i.str_suggestion_other_email_singular;break;default:a=i.str_suggestion_other_email_plural}return b=f.template(a,null)({emailAddress:h,number:d.length-1}),b||""}}),b.exports=d},{"../../../artifacts/lang":2,Context:"Context",StringUtils:"StringUtils",lodash:"lodash","react/addons":"react/addons"}],10:[function(a,b,c){"use strict";var d=a("lodash");d.forEach(["CONTACT_FETCH_INIT","CONTACT_FETCH_SUCCESS","CONTACT_FETCH_FAIL","IMPORTANT_SEARCH_UPDATE","IMPORTANT_SEARCH_ADD","IMPORTANT_SEARCH_REMOVE","IMPORTANT_SEARCH_CLEAR"],function(a){c[a]=d.uniqueId()})},{lodash:"lodash"}],11:[function(a,b,c){"use strict";YUI.add("tictac-important",function(b){b.namespace("Tictac").important={loader:function(){},launcher:function(){var b=a("AppDispatcher"),c=a("./stores/ImportantContactSuggestionsStore"),d=a("./stores/ImportantContactsStore"),e=a("./components/ImportantSetupContainer.jsx"),f=document.createElement("div");[c,d].forEach(b.registerStore),a("../../artifacts/css/main.css"),React.render(React.createElement(e,{context:b.context}),f),document.body.appendChild(f)}}},"1.0.0",{requires:["xobni-utilities","tictac-lib"]})},{"../../artifacts/css/main.css":1,"./components/ImportantSetupContainer.jsx":6,"./stores/ImportantContactSuggestionsStore":13,"./stores/ImportantContactsStore":14,AppDispatcher:"AppDispatcher"}],12:[function(a,b,c){"use strict";function d(a,b){var c,d=h.replace("{{ID}}",a);return c=Object.keys(b).map(function(a){return[encodeURIComponent(a),encodeURIComponent(b[a])].join("=")}),d+c.join("&")}function e(a){var b=this;f.merge(b,a),b.imageUrl||(b.imageUrl=d(b.serviceId,{spsize:"50X50",badge:!0,fallback_url:g.FALLBACK_XOBNI_IMG_URL}))}var f=a("lodash"),g=a("GlobalConstants"),h=yui.xobniContacts.Utils.getXobniBaseURL().url+"/v4/contacts/{{ID}}/photo?";e.prototype={constructor:e,getInitials:function(){var a=this.displayStr.split(" ");return[].concat(a.shift()||[]).concat(a.pop()||[]).map(function(a){return(a.charAt(0)||"").toUpperCase()}).join("")}},b.exports=e},{GlobalConstants:"GlobalConstants",lodash:"lodash"}],13:[function(a,b,c){"use strict";function d(a){return new i({serviceId:a.serviceId,displayStr:a.name,imageUrl:a.imageUrl,intent:a.intent,emailAddresses:a.emailAddresses})}function e(a){var b=this;b.dispatcher=a,b.contacts={}}var f=a("lodash"),g=a("events").EventEmitter,h=a("../constants/ImportantConstants"),i=a("../models/ImportantEntry"),j={};e.prototype=f.merge({constructor:e,get:function(){return this.contacts||[]},handleSuccess:function(a){var b=this,c=a.query,e=a.data;b.contacts=e.map(d,this).filter(function(a){var b=a.emailAddresses;return b}),f.isEmpty(b.contacts)||(b.contacts=b.contacts.concat(new i({displayStr:c.keyword,intent:"KEYWORD",keyword:c.keyword}))),b.emit("changed")},handleInit:function(){var a=this;a.contacts=[],a.emit("changed")}},g.prototype),j[h.CONTACT_FETCH_INIT]="handleInit",j[h.CONTACT_FETCH_SUCCESS]="handleSuccess",e.handlers=j,e.storeName="ImportantContactSuggestionsStore",b.exports=e},{"../constants/ImportantConstants":10,"../models/ImportantEntry":12,events:"events",lodash:"lodash"}],14:[function(a,b,c){"use strict";function d(a){var b=this;b.dispatcher=a,b.importantContacts=[]}var e=a("lodash"),f=a("../constants/ImportantConstants"),g=a("events").EventEmitter,h=a("../models/ImportantEntry"),i={};yui.use("mail-persist-meta-data"),d.prototype=e.merge({constructor:d,get:function(){return this.importantContacts},handleUpdate:function(a){this.importantContacts=(a||[]).map(function(a){return new h(a)}),this.emit("changed")},handleAdd:function(a){this.importantContacts.push(a),this.emit("changed")},handleClear:function(){this.importantContacts=[],this.emit("changed")},handleRemove:function(a){var b=a.index;this.importantContacts.splice(b,1),this.emit("changed")}},g.prototype),d.handlers=i,i[f.IMPORTANT_SEARCH_UPDATE]="handleUpdate",i[f.IMPORTANT_SEARCH_ADD]="handleAdd",i[f.IMPORTANT_SEARCH_CLEAR]="handleClear",i[f.IMPORTANT_SEARCH_REMOVE]="handleRemove",d.storeName="ImportantContactsStore",b.exports=d},{"../constants/ImportantConstants":10,"../models/ImportantEntry":12,events:"events",lodash:"lodash"}],15:[function(a,b,c){"use strict";function d(){return new Promise(function(a,b){yui.use("xobni-contacts-search-api").then(function(){yui.xobniContacts.searchAPI.fetch({query:"",limit:50},function(b){var c,d,e,f=[],g=0,h=NeoConfig.emailAddress;for(c=0;c<b.length&&19>g;c++){for(e=!1,b[c].e===h&&(e=!0),d=0;b[c].a_e.length>d;d++)if(b[c].a_e[d]===h){e=!0;break}if(!b[c].ke&&b[c].s>0&&!e&&(f.push({serviceId:b[c].i,displayStr:b[c].n,intent:"PEOPLE",emailAddresses:[b[c].e].concat(b[c].a_e)}),f.length>19))break}a(f)},function(){b()})},b)})}b.exports={fetchTopContactsSuggestions:d}},{}],16:[function(a,b,c){"use strict";function d(){var a=window.yui.mail.persist.MetaData.get("importantSearches");if(void 0===a)return null;if(!e.isString(a))return[];try{a=JSON.parse(a)}catch(b){a=[]}return a}var e=a("lodash");b.exports={parseImportantContacts:d}},{lodash:"lodash"}],17:[function(a,b,c){function d(a,b,c){var d=a.getElementById(b);if(d)c(d);else{var e=a.getElementsByTagName("head")[0];d=a.createElement("style"),d.id=b,c(d),e.appendChild(d)}return d}b.exports=function(a,b,c){var e=b||document;if(e.createStyleSheet){var f=e.createStyleSheet();return f.cssText=a,f.ownerNode}return d(e,c,function(b){b.styleSheet?b.styleSheet.cssText=a:b.innerHTML=a})},b.exports.byUrl=function(a){if(document.createStyleSheet)return document.createStyleSheet(a).ownerNode;var b=document.getElementsByTagName("head")[0],c=document.createElement("link");return c.rel="stylesheet",c.href=a,b.appendChild(c),c}},{}]},{},[11]);